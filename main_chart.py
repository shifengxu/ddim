import math
import os.path

import numpy as np
import torch
import torchvision as tv
import matplotlib.pyplot as plt

def fig_trajectory_ori_vs_new():
    fig = plt.figure(figsize=(16, 4))
    ax = fig.add_subplot(111)
    plt.xlim((0, 1.02))
    plt.ylim((-0.05, 1.05))
    plt.ylabel(r"$\bar{\alpha}_{t}$    ", fontsize=35, rotation=0)  # make it horizontal
    plt.xlabel('t', fontsize=30)
    plt.yticks(fontsize=25)
    plt.xticks(fontsize=25)
    # order = 1, steps = 10, skip_type = 'time_uniform'
    # ab: alpha_bar
    # ab_ori = [0.895328, 0.656884, 0.394732, 0.194200, 0.078190,
    #           0.025754, 0.006936, 0.001527, 0.000274, 0.000040, ]
    # ab_new = [0.905291, 0.673222, 0.411267, 0.206440, 0.085181,
    #           0.028907, 0.008075, 0.001858, 0.000353, 0.000055, ]
    # ts_ori = [0.099, 0.199, 0.299, 0.399, 0.499, 0.599, 0.699, 0.799, 0.899, 0.998]
    # ts_new = [0.094, 0.193, 0.292, 0.391, 0.490, 0.589, 0.688, 0.786, 0.885, 0.983]

    # order = 2, steps = 10, skip_type = 'time_quadratic'
    ab_ori = [0.995807, 0.970207, 0.889866, 0.723901, 0.481753,
              0.236788, 0.075947, 0.013741, 0.001185, 0.000040, ]
    ab_new = [0.991715, 0.956561, 0.868078, 0.697690, 0.457511,
              0.220373, 0.068510, 0.012959, 0.001219, 0.000054, ]
    ts_ori = [0.015, 0.049, 0.102, 0.174, 0.265, 0.374, 0.502, 0.649, 0.814, 0.998, ]
    ts_new = [0.023, 0.061, 0.113, 0.184, 0.274, 0.383, 0.512, 0.653, 0.813, 0.984, ]

    ax.plot(ts_ori, ab_ori, 'o', ms=10, color='blue')
    ax.plot(ts_new, ab_new, '*', ms=16, color='red')
    ax.plot(ts_ori, ab_ori, '--', ms=10, color='green')

    # add text. annotation for dot and star.
    ax.plot([0.48], [0.815], 'o', ms=10, color='blue')
    ax.text(0.5, 0.8, ': original trajectory', size=25)
    ax.plot([0.48], [0.715], '*', ms=16, color='red')
    ax.text(0.5, 0.7, ': improved trajectory', size=25)
    plt.show()
    fig.savefig('./configs/chart/abc_o2_s10_tq_v2.png')
    plt.close()

def merge_image():
    dir1 = './ckpt/2023-04-07_image_intermediate/bedroom_reverse_2_10_time_quadratic_new'
    dir2 = './ckpt/2023-04-07_image_intermediate/bedroom_reverse_2_10_time_quadratic_ori'
    dir3 = './ckpt/2023-04-07_image_intermediate/bedroom_reverse_2_10_time_quadratic_all'
    if not os.path.exists(dir3):
        print(f"mkdirs: {dir3}")
        os.makedirs(dir3)
    f_list = os.listdir(dir1)
    f_list.sort()  # file name list
    for fn in f_list:
        f1 = os.path.join(dir1, fn)
        f2 = os.path.join(dir2, fn)
        f3 = os.path.join(dir3, fn)
        i1, i2 = tv.io.read_image(f1), tv.io.read_image(f2)
        i1, i2 = i1.float(), i2.float()
        i1 /= 255.0
        i2 /= 255.0
        print(f"saving image: {f3}")
        tv.utils.save_image([i1, i2], f3, nrow=1)

def mse_error_vs_alpha_bar():
    mse_train = [1705.3052, 1490.751, 1357.769, 1259.209, 1180.147, 1113.053, 1055.815, 1005.528, 961.6980, 922.2376,
                 886.3626,  853.1224, 823.6397, 796.1513, 771.5246, 748.0213, 725.7368, 705.6533, 687.2634, 668.8577,
                 652.3686,  636.5029, 621.7116, 607.7314, 594.3815, 581.1665, 569.1201, 557.7317, 546.3212, 535.7988,
                 526.3934,  516.0354, 506.2507, 497.1383, 488.9288, 480.4435, 472.5754, 464.8413, 457.6023, 450.4096,
                 443.5321,  436.8423, 430.5373, 424.2699, 418.0489, 412.0598, 406.6159, 400.7833, 395.1656, 390.1971,
                 385.0297,  379.6522, 375.0673, 370.0567, 365.7768, 361.3683, 357.5555, 352.8554, 348.5974, 344.4448,
                 340.2772,  336.7190, 332.7570, 328.8578, 325.5562, 322.0782, 318.4112, 315.4662, 312.2982, 308.5296,
                 305.5826,  302.5058, 299.2368, 296.7647, 293.5805, 290.5803, 287.8286, 284.9799, 282.5154, 279.5815,
                 277.1923,  274.6056, 271.8127, 269.2436, 266.8705, 264.9790, 262.6287, 259.5336, 257.6445, 255.7327,
                 253.2283,  251.1605, 248.8405, 247.1809, 245.1223, 242.9071, 240.9020, 238.6637, 236.9742, 235.1563,
                 233.1047,  231.2142, 229.5569, 227.6611, 225.9228, 224.2408, 222.0648, 220.8499, 218.9794, 217.5237,
                 215.6276,  214.4675, 212.2608, 211.2312, 209.5897, 207.9467, 206.5449, 204.8998, 203.5736, 201.9733,
                 200.6272,  199.0281, 197.8833, 196.4148, 195.0383, 193.7037, 192.3497, 191.3696, 189.6585, 188.6138,
                 187.2588,  185.8104, 184.6033, 183.3989, 182.2334, 180.9580, 179.9383, 178.8401, 177.8477, 176.3954,
                 174.9611,  174.1767, 173.1423, 171.7789, 170.8738, 169.5992, 168.7716, 167.5242, 166.4832, 165.5540,
                 164.3672,  163.3144, 162.6938, 161.2135, 160.5441, 159.3985, 158.4887, 157.5202, 156.3539, 155.2134,
                 154.7291,  153.6995, 152.8994, 152.2177, 150.8117, 150.2221, 149.2547, 148.2679, 147.2931, 146.8859,
                 145.9328,  145.1746, 143.8815, 143.0784, 142.4243, 141.6891, 141.1239, 140.0489, 139.3714, 138.2265,
                 137.6741,  136.9887, 136.0607, 135.3512, 134.3541, 133.6739, 132.9657, 132.2595, 131.7923, 130.6665,
                 130.1509,  129.3978, 128.7098, 127.7371, 127.3843, 126.4210, 125.8299, 125.1344, 124.5666, 123.7103,
                 123.1872,  122.8112, 121.7882, 121.3710, 120.4093, 120.0775, 119.1173, 118.6743, 117.8459, 117.1546,
                 116.7661,  116.1730, 115.4415, 114.8156, 114.3402, 113.6634, 112.7953, 112.3872, 111.7422, 111.5167,
                 110.5641,  109.9418, 109.4167, 108.8275, 108.2795, 107.9979, 107.2655, 106.5904, 106.1220, 105.4803,
                 104.9201,  104.3856, 103.8021, 103.4547, 102.7982, 102.3114, 101.8574, 101.2055, 100.5852, 100.2613,
                 99.7880,   99.1088,  98.5425,  98.2047,  97.6593,  97.2044,  96.7800,  96.1823,  95.5994,  95.0609,
                 94.7589,   94.2668,  93.9356,  93.4147,  92.7418,  92.1927,  91.8088,  91.1356,  90.7743,  90.4670,
                 89.7975,   89.2281,  89.1319,  88.6145,  88.2058,  87.6820,  87.2445,  86.7831,  86.5592,  85.9622,
                 85.5060,   85.0054,  84.5894,  84.1799,  83.8106,  83.3989,  83.0173,  82.4999,  82.0417,  81.2653,
                 81.2808,   80.8565,  80.3103,  79.8974,  79.7311,  79.4685,  78.7124,  78.3692,  78.0367,  77.6269,
                 77.2734,   76.8840,  76.3997,  76.1165,  75.6622,  75.0944,  74.9530,  74.3371,  74.3220,  73.8984,
                 73.5931,   73.0424,  72.7156,  72.2662,  71.8400,  71.5151,  71.1261,  70.9025,  70.6319,  70.0502,
                 69.8508,   69.1014,  69.1003,  68.8406,  68.4542,  68.0255,  67.5860,  67.1134,  66.9351,  66.6637,
                 66.2207,   66.0162,  65.6299,  65.1595,  65.0152,  64.4956,  64.2421,  63.9557,  63.6129,  63.2795,
                 62.8452,   62.7248,  62.1553,  61.8995,  61.5551,  61.1821,  61.0390,  60.8323,  60.4939,  60.0583,
                 59.7300,   59.5000,  59.1240,  58.8828,  58.4195,  58.2287,  57.9792,  57.4583,  57.3090,  56.8279,
                 56.5400,   56.2844,  56.1274,  55.7306,  55.4490,  55.0650,  54.9266,  54.5190,  54.2934,  54.1284,
                 53.7494,   53.4853,  53.1171,  52.7800,  52.4800,  52.2412,  52.1112,  51.7029,  51.3073,  51.1136,
                 50.8783,   50.6329,  50.3606,  50.0936,  49.8246,  49.5731,  49.2575,  48.9859,  48.6540,  48.5090,
                 48.1911,   47.8937,  47.6356,  47.3534,  47.1068,  46.9312,  46.6893,  46.3831,  46.1534,  45.9448,
                 45.6155,   45.1919,  45.0898,  44.7300,  44.6251,  44.3876,  44.1818,  43.7717,  43.5999,  43.3299,
                 43.1016,   42.7425,  42.6224,  42.4013,  42.1593,  41.9861,  41.7675,  41.3717,  41.3062,  40.9605,
                 40.7425,   40.5288,  40.2482,  39.9561,  39.6078,  39.4857,  39.3279,  39.0591,  38.8684,  38.5279,
                 38.4205,   38.1757,  37.9486,  37.6957,  37.5541,  37.3968,  37.0005,  36.8150,  36.6904,  36.3720,
                 36.0993,   35.9364,  35.6778,  35.5192,  35.3905,  35.0816,  34.9033,  34.6816,  34.4329,  34.2499,
                 34.1554,   33.8467,  33.6169,  33.4850,  33.3221,  33.0967,  32.9200,  32.6799,  32.2654,  32.2300,
                 32.0742,   31.8131,  31.5737,  31.4439,  31.3028,  30.9707,  30.8816,  30.6562,  30.4944,  30.3117,
                 30.0670,   29.7857,  29.7729,  29.5308,  29.3334,  29.1710,  28.8725,  28.7110,  28.5622,  28.4895,
                 28.2315,   27.9791,  27.8540,  27.6635,  27.4547,  27.2645,  27.1394,  26.9090,  26.7632,  26.6655,
                 26.3945,   26.2840,  26.0380,  25.8927,  25.7174,  25.5010,  25.4538,  25.2507,  24.9989,  24.9146,
                 24.7076,   24.5101,  24.4064,  24.1638,  23.9779,  23.9133,  23.6527,  23.5553,  23.4321,  23.2572,
                 23.0916,   22.8914,  22.7866,  22.5256,  22.4829,  22.3053,  22.0151,  21.9661,  21.7823,  21.6602,
                 21.5542,   21.4092,  21.1979,  21.1186,  20.8794,  20.7735,  20.5936,  20.4771,  20.2109,  20.1177,
                 20.0373,   19.8644,  19.7863,  19.5815,  19.5352,  19.3412,  19.1337,  19.0215,  18.8967,  18.7244,
                 18.6209,   18.5130,  18.3634,  18.2401,  18.0478,  17.9159,  17.7692,  17.6391,  17.5045,  17.3314,
                 17.2776,   17.0462,  16.9875,  16.8460,  16.7033,  16.5932,  16.4773,  16.3641,  16.2631,  16.0627,
                 15.9077,   15.8264,  15.6880,  15.5711,  15.4351,  15.3735,  15.2356,  15.1440,  14.9958,  14.9071,
                 14.7987,   14.6219,  14.5455,  14.4000,  14.3279,  14.2387,  14.0416,  13.9980,  13.8611,  13.7467,
                 13.6220,   13.5127,  13.3533,  13.2665,  13.1749,  13.0431,  12.9252,  12.7903,  12.7747,  12.5972,
                 12.5234,   12.3913,  12.3456,  12.1978,  12.0667,  11.9872,  11.8891,  11.8044,  11.7197,  11.5707,
                 11.5069,   11.3609,  11.3017,  11.1925,  11.0829,  11.0349,  10.9110,  10.8116,  10.6885,  10.6080,
                 10.5097,   10.3895,  10.3698,  10.2470,  10.1835,  10.0406,   9.9988,   9.8740,   9.8244,   9.7626,
                 9.6746,    9.5265,   9.4777,   9.3428,   9.2805,   9.2192,   9.1162,   9.0257,   8.9442,   8.8571,
                 8.8033,    8.6783,   8.6282,   8.5601,   8.5016,   8.3815,   8.3250,   8.2468,   8.1347,   8.0871,
                 8.0090,    7.9260,   7.8260,   7.7631,   7.6698,   7.6261,   7.5226,   7.4656,   7.3805,   7.3327,
                 7.2780,    7.1562,   7.1322,   7.0521,   6.9706,   6.9255,   6.8230,   6.7577,   6.6908,   6.6331,
                 6.5475,    6.5074,   6.4429,   6.3536,   6.2998,   6.2350,   6.1930,   6.1146,   6.0626,   5.9859,
                 5.9490,    5.8717,   5.8143,   5.7384,   5.6807,   5.6592,   5.5733,   5.4847,   5.4663,   5.3975,
                 5.3406,    5.2669,   5.2209,   5.1822,   5.1358,   5.0757,   5.0218,   4.9419,   4.9161,   4.8511,
                 4.7959,    4.7468,   4.6944,   4.6639,   4.5952,   4.5509,   4.4910,   4.4641,   4.3970,   4.3181,
                 4.2961,    4.2472,   4.1973,   4.1602,   4.0988,   4.0561,   4.0121,   3.9860,   3.9282,   3.8668,
                 3.8278,    3.8096,   3.7524,   3.7088,   3.6546,   3.6081,   3.5748,   3.5301,   3.4875,   3.4438,
                 3.4156,    3.3904,   3.3387,   3.3110,   3.2779,   3.2200,   3.1829,   3.1543,   3.1064,   3.0871,
                 3.0319,    3.0032,   2.9609,   2.9311,   2.8902,   2.8703,   2.8185,   2.7919,   2.7621,   2.7262,
                 2.6834,    2.6456,   2.6236,   2.5809,   2.5499,   2.5353,   2.4908,   2.4593,   2.4248,   2.4127,
                 2.3570,    2.3430,   2.3093,   2.2847,   2.2549,   2.2303,   2.2040,   2.1728,   2.1403,   2.1183,
                 2.0746,    2.0598,   2.0302,   2.0020,   1.9753,   1.9500,   1.9311,   1.9014,   1.8737,   1.8540,
                 1.8303,    1.8133,   1.7846,   1.7690,   1.7401,   1.7202,   1.6929,   1.6726,   1.6482,   1.6256,
                 1.6098,    1.5783,   1.5644,   1.5412,   1.5216,   1.4949,   1.4727,   1.4525,   1.4336,   1.4202,
                 1.3965,    1.3793,   1.3589,   1.3382,   1.3218,   1.3019,   1.2904,   1.2681,   1.2452,   1.2260,
                 1.2216,    1.2043,   1.1792,   1.1614,   1.1445,   1.1316,   1.1168,   1.0972,   1.0847,   1.0655,
                 1.0544,    1.0372,   1.0191,   1.0066,   0.9883,   0.9772,   0.9592,   0.9515,   0.9359,   0.9224,
                 0.9113,    0.8933,   0.8835,   0.8640,   0.8579,   0.8443,   0.8297,   0.8194,   0.8091,   0.7955,
                 0.7828,    0.7699,   0.7583,   0.7480,   0.7361,   0.7268,   0.7133,   0.7029,   0.6918,   0.6838,
                 0.6711,    0.6617,   0.6523,   0.6446,   0.6323,   0.6222,   0.6146,   0.6051,   0.5962,   0.5850,
                 0.5750,    0.5679,   0.5565,   0.5493,   0.5428,   0.5331,   0.5255,   0.5161,   0.5093,   0.5021,
                 0.4926,    0.4854,   0.4777,   0.4716,   0.4646,   0.4545,   0.4498,   0.4432,   0.4356,   0.4294,
                 0.4214,    0.4138,   0.4087,   0.4018,   0.3950,   0.3899,   0.3835,   0.3764,   0.3731,   0.3649,
                 0.3585,    0.3539,   0.3484,   0.3427,   0.3378,   0.3314,   0.3262,   0.3210,   0.3176,   0.3126,
                 0.3059,    0.3018,   0.2968,   0.2914,   0.2876,   0.2825,   0.2789,   0.2745,   0.2700,   0.2659,
                 0.2610,    0.2561,   0.2524,   0.2487,   0.2441,   0.2403,   0.2366,   0.2328,   0.2291,   0.2252,
                 0.2214,    0.2180,   0.2142,   0.2111,   0.2081,   0.2049,   0.2015,   0.1980,   0.1954,   0.1918,
                 0.1887,    0.1862,   0.1829,   0.1807,   0.1777,   0.1746,   0.1721,   0.1694,   0.1667,   0.1642,
                 0.1612,    0.1592,   0.1564,   0.1540,   0.1521,   0.1494,   0.1471,   0.1447,   0.1428,   0.1400,
                 0.1376,    0.1356,   0.1335,   0.1317,   0.1297,   0.1279,   0.1258,   0.1241,   0.1218,   0.1198,
                 0.1183,    0.1168,   0.1153,   0.1135,   0.1118,   0.1099,   0.1080,   0.1067,   0.1050,   0.1035,
                 0.1015,    0.1000,   0.0985,   0.0969,   0.0955,   0.0942,   0.0926,   0.0913,   0.0901,   0.0890,
                 0.0880,    0.0870,   0.0861,   0.0848,   0.0835,   0.0821,   0.0806,   0.0802,   0.0788,   0.0775,
                 0.0763,    0.0755,   0.0742,   0.0732,   0.0725,   0.0711,   0.0704,   0.0697,   0.0689,   0.0679,
                 0.0671,    0.0662,   0.0652,   0.0644,   0.0632,   0.0626,   0.0617,   0.0612,   0.0606,   0.0594,
                 0.0590,    0.0581,   0.0576,   0.0570,   0.0562,   0.0555,   0.0549,   0.0545,   0.0539,   0.0534]
    mse_test  = [1705.305, 1490.751, 1357.769, 1259.209, 1180.147, 1113.052, 1055.814, 1005.528, 961.6980, 922.2376,
                 886.3626, 853.1224, 823.6397, 796.1513, 771.5246, 748.0213, 725.7368, 705.6533, 687.2634, 668.8577,
                 652.3686, 636.5029, 621.7116, 607.7314, 594.3815, 581.1665, 569.1201, 557.7317, 546.3212, 535.7988,
                 526.3934, 516.0354, 506.2507, 497.1383, 488.9288, 480.4435, 472.5754, 464.8413, 457.6023, 450.4096,
                 443.5321, 436.8423, 430.5373, 424.2699, 418.0489, 412.0598, 406.6159, 400.7833, 395.1656, 390.1971,
                 385.0297, 379.6522, 375.0673, 370.0567, 365.7768, 361.3683, 357.5555, 352.8554, 348.5974, 344.4448,
                 340.2772, 336.7190, 332.7570, 328.8578, 325.5562, 322.0782, 318.4112, 315.4662, 312.2982, 308.5296,
                 305.5826, 302.5058, 299.2368, 296.7647, 293.5805, 290.5803, 287.8286, 284.9799, 282.5154, 279.5815,
                 277.1923, 274.6056, 271.8127, 269.2436, 266.8705, 264.9790, 262.6287, 259.5336, 257.6445, 255.7327,
                 253.2283, 251.1605, 248.8405, 247.1809, 245.1223, 242.9071, 240.9020, 238.6637, 236.9742, 235.1563,
                 233.1047, 231.2142, 229.5569, 227.6611, 225.9228, 224.2408, 222.0648, 220.8499, 218.9794, 217.5237,
                 215.6276, 214.4675, 212.2608, 211.2312, 209.5897, 207.9467, 206.5449, 204.8998, 203.5736, 201.9733,
                 200.6272, 199.0281, 197.8833, 196.4148, 195.0383, 193.7037, 192.3497, 191.3696, 189.6585, 188.6138,
                 187.2588, 185.8104, 184.6033, 183.3989, 182.2334, 180.9580, 179.9383, 178.8401, 177.8477, 176.3954,
                 174.9611, 174.1767, 173.1423, 171.7789, 170.8738, 169.5992, 168.7716, 167.5242, 166.4832, 165.5540,
                 164.3672, 163.3144, 162.6938, 161.2135, 160.5441, 159.3985, 158.4887, 157.5202, 156.3539, 155.2134,
                 154.7291, 153.6995, 152.8994, 152.2177, 150.8117, 150.2221, 149.2547, 148.2679, 147.2931, 146.8859,
                 145.9328, 145.1746, 143.8815, 143.0784, 142.4243, 141.6891, 141.1239, 140.0489, 139.3714, 138.2265,
                 137.6741, 136.9887, 136.0607, 135.3512, 134.3541, 133.6739, 132.9657, 132.2595, 131.7923, 130.6665,
                 130.1509, 129.3978, 128.7098, 127.7371, 127.3843, 126.4210, 125.8299, 125.1344, 124.5666, 123.7103,
                 123.1872, 122.8112, 121.7882, 121.3710, 120.4093, 120.0775, 119.1173, 118.6743, 117.8459, 117.1546,
                 116.7661, 116.1730, 115.4415, 114.8156, 114.3402, 113.6634, 112.7953, 112.3872, 111.7422, 111.5167,
                 110.5641, 109.9418, 109.4167, 108.8275, 108.2795, 107.9979, 107.2655, 106.5904, 106.1220, 105.4803,
                 104.9201, 104.3856, 103.8021, 103.4547, 102.7982, 102.3114, 101.8574, 101.2055, 100.5852, 100.2613,
                 99.7880,  99.1088,  98.5425,  98.2047,  97.6593,  97.2044,  96.7800,  96.1823,  95.5994,  95.0609,
                 94.7589,  94.2668,  93.9356,  93.4147,  92.7418,  92.1927,  91.8088,  91.1356,  90.7743,  90.4670,
                 89.7975,  89.2281,  89.1319,  88.6145,  88.2058,  87.6820,  87.2445,  86.7831,  86.5592,  85.9622,
                 85.5060,  85.0054,  84.5894,  84.1799,  83.8106,  83.3989,  83.0173,  82.4999,  82.0417,  81.2653,
                 81.2808,  80.8565,  80.3103,  79.8974,  79.7311,  79.4685,  78.7124,  78.3692,  78.0367,  77.6269,
                 77.2734,  76.8840,  76.3997,  76.1165,  75.6622,  75.0944,  74.9530,  74.3371,  74.3220,  73.8984,
                 73.5931,  73.0424,  72.7156,  72.2662,  71.8400,  71.5151,  71.1261,  70.9025,  70.6319,  70.0502,
                 69.8508,  69.1014,  69.1003,  68.8406,  68.4542,  68.0255,  67.5860,  67.1134,  66.9351,  66.6637,
                 66.2207,  66.0162,  65.6299,  65.1595,  65.0152,  64.4956,  64.2421,  63.9557,  63.6129,  63.2795,
                 62.8452,  62.7248,  62.1553,  61.8995,  61.5551,  61.1821,  61.0390,  60.8323,  60.4939,  60.0583,
                 59.7300,  59.5000,  59.1240,  58.8828,  58.4195,  58.2287,  57.9792,  57.4583,  57.3090,  56.8279,
                 56.5400,  56.2844,  56.1274,  55.7306,  55.4490,  55.0650,  54.9266,  54.5190,  54.2934,  54.1284,
                 53.7494,  53.4853,  53.1171,  52.7800,  52.4800,  52.2412,  52.1112,  51.7029,  51.3073,  51.1136,
                 50.8783,  50.6329,  50.3606,  50.0936,  49.8246,  49.5731,  49.2575,  48.9859,  48.6540,  48.5090,
                 48.1911,  47.8937,  47.6356,  47.3534,  47.1068,  46.9312,  46.6893,  46.3831,  46.1534,  45.9448,
                 45.6155,  45.1919,  45.0898,  44.7300,  44.6251,  44.3876,  44.1818,  43.7717,  43.5999,  43.3299,
                 43.1016,  42.7425,  42.6224,  42.4013,  42.1593,  41.9861,  41.7675,  41.3717,  41.3062,  40.9605,
                 40.7425,  40.5288,  40.2482,  39.9561,  39.6078,  39.4857,  39.3279,  39.0591,  38.8684,  38.5279,
                 38.4205,  38.1757,  37.9486,  37.6957,  37.5541,  37.3968,  37.0005,  36.8150,  36.6904,  36.3720,
                 36.0993,  35.9364,  35.6778,  35.5192,  35.3905,  35.0816,  34.9033,  34.6816,  34.4329,  34.2499,
                 34.1554,  33.8467,  33.6169,  33.4850,  33.3221,  33.0967,  32.9200,  32.6799,  32.2654,  32.2300,
                 32.0742,  31.8131,  31.5737,  31.4439,  31.3028,  30.9707,  30.8816,  30.6562,  30.4944,  30.3117,
                 30.0670,  29.7857,  29.7729,  29.5308,  29.3334,  29.1710,  28.8725,  28.7110,  28.5622,  28.4895,
                 28.2315,  27.9791,  27.8540,  27.6635,  27.4547,  27.2645,  27.1394,  26.9090,  26.7632,  26.6655,
                 26.3945,  26.2840,  26.0380,  25.8927,  25.7174,  25.5010,  25.4538,  25.2507,  24.9989,  24.9146,
                 24.7076,  24.5101,  24.4064,  24.1638,  23.9779,  23.9133,  23.6527,  23.5553,  23.4321,  23.2572,
                 23.0916,  22.8914,  22.7866,  22.5256,  22.4829,  22.3053,  22.0151,  21.9661,  21.7823,  21.6602,
                 21.5542,  21.4092,  21.1979,  21.1186,  20.8794,  20.7735,  20.5936,  20.4771,  20.2109,  20.1177,
                 20.0373,  19.8644,  19.7863,  19.5815,  19.5352,  19.3412,  19.1337,  19.0215,  18.8967,  18.7244,
                 18.6209,  18.5130,  18.3634,  18.2401,  18.0478,  17.9159,  17.7692,  17.6391,  17.5045,  17.3314,
                 17.2776,  17.0462,  16.9875,  16.8460,  16.7033,  16.5932,  16.4773,  16.3641,  16.2631,  16.0627,
                 15.9077,  15.8264,  15.6880,  15.5711,  15.4351,  15.3735,  15.2356,  15.1440,  14.9958,  14.9071,
                 14.7987,  14.6219,  14.5455,  14.4000,  14.3279,  14.2387,  14.0416,  13.9980,  13.8611,  13.7467,
                 13.6220,  13.5127,  13.3533,  13.2665,  13.1749,  13.0431,  12.9252,  12.7903,  12.7747,  12.5972,
                 12.5234,  12.3913,  12.3456,  12.1978,  12.0667,  11.9872,  11.8891,  11.8044,  11.7197,  11.5707,
                 11.5069,  11.3609,  11.3017,  11.1925,  11.0829,  11.0349,  10.9110,  10.8116,  10.6885,  10.6080,
                 10.5097,  10.3895,  10.3698,  10.2470,  10.1835,  10.0406,  9.9988,   9.8740,   9.8244,   9.7626,
                 9.6746,   9.5265,   9.4777,   9.3428,   9.2805,   9.2192,   9.1162,   9.0257,   8.9442,   8.8571,
                 8.8033,   8.6783,   8.6282,   8.5601,   8.5016,   8.3815,   8.3250,   8.2468,   8.1347,   8.0871,
                 8.0090,   7.9260,   7.8260,   7.7631,   7.6698,   7.6261,   7.5226,   7.4656,   7.3805,   7.3327,
                 7.2780,   7.1562,   7.1322,   7.0521,   6.9706,   6.9255,   6.8230,   6.7577,   6.6908,   6.6331,
                 6.5475,   6.5074,   6.4429,   6.3536,   6.2998,   6.2350,   6.1930,   6.1146,   6.0626,   5.9859,
                 5.9490,   5.8717,   5.8143,   5.7384,   5.6807,   5.6592,   5.5733,   5.4847,   5.4663,   5.3975,
                 5.3406,   5.2669,   5.2209,   5.1822,   5.1358,   5.0757,   5.0218,   4.9419,   4.9161,   4.8511,
                 4.7959,   4.7468,   4.6944,   4.6639,   4.5952,   4.5509,   4.4910,   4.4641,   4.3970,   4.3181,
                 4.2961,   4.2472,   4.1973,   4.1602,   4.0988,   4.0561,   4.0121,   3.9860,   3.9282,   3.8668,
                 3.8278,   3.8096,   3.7524,   3.7088,   3.6546,   3.6081,   3.5748,   3.5301,   3.4875,   3.4438,
                 3.4156,   3.3904,   3.3387,   3.3110,   3.2779,   3.2200,   3.1829,   3.1543,   3.1064,   3.0871,
                 3.0319,   3.0032,   2.9609,   2.9311,   2.8902,   2.8703,   2.8185,   2.7919,   2.7621,   2.7262,
                 2.6834,   2.6456,   2.6236,   2.5809,   2.5499,   2.5353,   2.4908,   2.4593,   2.4248,   2.4127,
                 2.3570,   2.3430,   2.3093,   2.2847,   2.2549,   2.2303,   2.2040,   2.1728,   2.1403,   2.1183,
                 2.0746,   2.0598,   2.0302,   2.0020,   1.9753,   1.9500,   1.9311,   1.9014,   1.8737,   1.8540,
                 1.8303,   1.8133,   1.7846,   1.7690,   1.7401,   1.7202,   1.6929,   1.6726,   1.6482,   1.6256,
                 1.6098,   1.5783,   1.5644,   1.5412,   1.5216,   1.4949,   1.4727,   1.4525,   1.4336,   1.4202,
                 1.3965,   1.3793,   1.3589,   1.3382,   1.3218,   1.3019,   1.2904,   1.2681,   1.2452,   1.2260,
                 1.2216,   1.2043,   1.1792,   1.1614,   1.1445,   1.1316,   1.1168,   1.0972,   1.0847,   1.0655,
                 1.0544,   1.0372,   1.0191,   1.0066,   0.9883,   0.9772,   0.9592,   0.9515,   0.9359,   0.9224,
                 0.9113,   0.8933,   0.8835,   0.8640,   0.8579,   0.8443,   0.8297,   0.8194,   0.8091,   0.7955,
                 0.7828,   0.7699,   0.7583,   0.7480,   0.7361,   0.7268,   0.7133,   0.7029,   0.6918,   0.6838,
                 0.6711,   0.6617,   0.6523,   0.6446,   0.6323,   0.6222,   0.6146,   0.6051,   0.5962,   0.5850,
                 0.5750,   0.5679,   0.5565,   0.5493,   0.5428,   0.5331,   0.5255,   0.5161,   0.5093,   0.5021,
                 0.4926,   0.4854,   0.4777,   0.4716,   0.4646,   0.4545,   0.4498,   0.4432,   0.4356,   0.4294,
                 0.4214,   0.4138,   0.4087,   0.4018,   0.3950,   0.3899,   0.3835,   0.3764,   0.3731,   0.3649,
                 0.3585,   0.3539,   0.3484,   0.3427,   0.3378,   0.3314,   0.3262,   0.3210,   0.3176,   0.3126,
                 0.3059,   0.3018,   0.2968,   0.2914,   0.2876,   0.2825,   0.2789,   0.2745,   0.2700,   0.2659,
                 0.2610,   0.2561,   0.2524,   0.2487,   0.2441,   0.2403,   0.2366,   0.2328,   0.2291,   0.2252,
                 0.2214,   0.2180,   0.2142,   0.2111,   0.2081,   0.2049,   0.2015,   0.1980,   0.1954,   0.1918,
                 0.1887,   0.1862,   0.1829,   0.1807,   0.1777,   0.1746,   0.1721,   0.1694,   0.1667,   0.1642,
                 0.1612,   0.1592,   0.1564,   0.1540,   0.1521,   0.1494,   0.1471,   0.1447,   0.1428,   0.1400,
                 0.1376,   0.1356,   0.1335,   0.1317,   0.1297,   0.1279,   0.1258,   0.1241,   0.1218,   0.1198,
                 0.1183,   0.1168,   0.1153,   0.1135,   0.1118,   0.1099,   0.1080,   0.1067,   0.1050,   0.1035,
                 0.1015,   0.1000,   0.0985,   0.0969,   0.0955,   0.0942,   0.0926,   0.0913,   0.0901,   0.0890,
                 0.0880,   0.0870,   0.0861,   0.0848,   0.0835,   0.0821,   0.0806,   0.0802,   0.0788,   0.0775,
                 0.0763,   0.0755,   0.0742,   0.0732,   0.0725,   0.0711,   0.0704,   0.0697,   0.0689,   0.0679,
                 0.0671,   0.0662,   0.0652,   0.0644,   0.0632,   0.0626,   0.0617,   0.0612,   0.0606,   0.0594,
                 0.0590,   0.0581,   0.0576,   0.0570,   0.0562,   0.0555,   0.0549,   0.0545,   0.0539,   0.0534, ]
    alpha_bar = [0.999900, 0.999780, 0.999640, 0.999481, 0.999301, 0.999102, 0.998882, 0.998643, 0.998384, 0.998105,
                 0.997807, 0.997488, 0.997150, 0.996792, 0.996414, 0.996017, 0.995600, 0.995163, 0.994707, 0.994231,
                 0.993735, 0.993220, 0.992686, 0.992131, 0.991558, 0.990965, 0.990353, 0.989721, 0.989070, 0.988400,
                 0.987710, 0.987002, 0.986274, 0.985527, 0.984761, 0.983976, 0.983172, 0.982349, 0.981507, 0.980646,
                 0.979767, 0.978869, 0.977952, 0.977016, 0.976062, 0.975090, 0.974099, 0.973089, 0.972062, 0.971016,
                 0.969951, 0.968869, 0.967768, 0.966650, 0.965514, 0.964359, 0.963187, 0.961997, 0.960789, 0.959564,
                 0.958321, 0.957061, 0.955783, 0.954488, 0.953176, 0.951846, 0.950500, 0.949136, 0.947756, 0.946358,
                 0.944944, 0.943513, 0.942065, 0.940601, 0.939121, 0.937624, 0.936110, 0.934581, 0.933035, 0.931474,
                 0.929896, 0.928303, 0.926694, 0.925069, 0.923428, 0.921773, 0.920101, 0.918415, 0.916713, 0.914996,
                 0.913264, 0.911517, 0.909756, 0.907979, 0.906188, 0.904383, 0.902563, 0.900729, 0.898880, 0.897018,
                 0.895141, 0.893251, 0.891347, 0.889429, 0.887497, 0.885552, 0.883594, 0.881622, 0.879637, 0.877639,
                 0.875629, 0.873605, 0.871569, 0.869520, 0.867458, 0.865384, 0.863298, 0.861200, 0.859089, 0.856967,
                 0.854832, 0.852687, 0.850529, 0.848360, 0.846180, 0.843988, 0.841785, 0.839572, 0.837347, 0.835112,
                 0.832865, 0.830609, 0.828342, 0.826064, 0.823777, 0.821479, 0.819171, 0.816854, 0.814527, 0.812190,
                 0.809844, 0.807488, 0.805123, 0.802750, 0.800367, 0.797975, 0.795574, 0.793165, 0.790747, 0.788321,
                 0.785887, 0.783444, 0.780994, 0.778536, 0.776069, 0.773596, 0.771114, 0.768626, 0.766130, 0.763626,
                 0.761116, 0.758599, 0.756075, 0.753545, 0.751008, 0.748464, 0.745914, 0.743358, 0.740797, 0.738229,
                 0.735655, 0.733075, 0.730490, 0.727900, 0.725304, 0.722703, 0.720097, 0.717486, 0.714871, 0.712250,
                 0.709625, 0.706995, 0.704362, 0.701724, 0.699081, 0.696435, 0.693785, 0.691131, 0.688474, 0.685813,
                 0.683149, 0.680481, 0.677811, 0.675137, 0.672461, 0.669782, 0.667099, 0.664415, 0.661728, 0.659039,
                 0.656347, 0.653654, 0.650958, 0.648261, 0.645561, 0.642861, 0.640158, 0.637455, 0.634750, 0.632044,
                 0.629336, 0.626628, 0.623919, 0.621210, 0.618500, 0.615789, 0.613078, 0.610366, 0.607655, 0.604943,
                 0.602232, 0.599520, 0.596809, 0.594098, 0.591388, 0.588678, 0.585969, 0.583261, 0.580554, 0.577847,
                 0.575142, 0.572438, 0.569735, 0.567034, 0.564334, 0.561636, 0.558940, 0.556245, 0.553552, 0.550861,
                 0.548173, 0.545486, 0.542802, 0.540120, 0.537441, 0.534764, 0.532090, 0.529419, 0.526751, 0.524085,
                 0.521423, 0.518764, 0.516108, 0.513455, 0.510806, 0.508160, 0.505518, 0.502880, 0.500245, 0.497614,
                 0.494987, 0.492364, 0.489745, 0.487130, 0.484520, 0.481914, 0.479312, 0.476715, 0.474122, 0.471534,
                 0.468951, 0.466372, 0.463799, 0.461230, 0.458667, 0.456108, 0.453555, 0.451007, 0.448464, 0.445927,
                 0.443395, 0.440869, 0.438348, 0.435833, 0.433324, 0.430821, 0.428324, 0.425832, 0.423346, 0.420867,
                 0.418394, 0.415926, 0.413466, 0.411011, 0.408563, 0.406121, 0.403686, 0.401257, 0.398835, 0.396420,
                 0.394011, 0.391609, 0.389214, 0.386826, 0.384445, 0.382071, 0.379704, 0.377344, 0.374991, 0.372645,
                 0.370307, 0.367976, 0.365652, 0.363335, 0.361027, 0.358725, 0.356431, 0.354145, 0.351866, 0.349595,
                 0.347331, 0.345076, 0.342828, 0.340588, 0.338356, 0.336131, 0.333915, 0.331706, 0.329506, 0.327314,
                 0.325129, 0.322953, 0.320785, 0.318625, 0.316473, 0.314329, 0.312194, 0.310067, 0.307949, 0.305838,
                 0.303736, 0.301643, 0.299558, 0.297481, 0.295413, 0.293353, 0.291302, 0.289259, 0.287225, 0.285200,
                 0.283183, 0.281174, 0.279175, 0.277184, 0.275201, 0.273228, 0.271263, 0.269307, 0.267359, 0.265420,
                 0.263490, 0.261569, 0.259657, 0.257754, 0.255859, 0.253973, 0.252096, 0.250228, 0.248368, 0.246518,
                 0.244676, 0.242844, 0.241020, 0.239205, 0.237399, 0.235602, 0.233814, 0.232034, 0.230264, 0.228503,
                 0.226750, 0.225007, 0.223272, 0.221546, 0.219829, 0.218121, 0.216422, 0.214732, 0.213051, 0.211379,
                 0.209716, 0.208061, 0.206416, 0.204779, 0.203152, 0.201533, 0.199923, 0.198322, 0.196730, 0.195146,
                 0.193572, 0.192006, 0.190450, 0.188902, 0.187363, 0.185832, 0.184311, 0.182798, 0.181294, 0.179799,
                 0.178313, 0.176835, 0.175366, 0.173906, 0.172454, 0.171011, 0.169577, 0.168152, 0.166735, 0.165326,
                 0.163927, 0.162535, 0.161153, 0.159779, 0.158413, 0.157056, 0.155708, 0.154368, 0.153036, 0.151713,
                 0.150399, 0.149092, 0.147794, 0.146505, 0.145224, 0.143951, 0.142686, 0.141430, 0.140182, 0.138942,
                 0.137710, 0.136487, 0.135271, 0.134064, 0.132865, 0.131674, 0.130491, 0.129316, 0.128149, 0.126990,
                 0.125839, 0.124696, 0.123561, 0.122433, 0.121314, 0.120202, 0.119098, 0.118002, 0.116914, 0.115833,
                 0.114760, 0.113695, 0.112637, 0.111587, 0.110544, 0.109509, 0.108482, 0.107462, 0.106449, 0.105444,
                 0.104447, 0.103456, 0.102473, 0.101497, 0.100529, 0.099568, 0.098614, 0.097667, 0.096727, 0.095794,
                 0.094869, 0.093950, 0.093039, 0.092134, 0.091237, 0.090346, 0.089463, 0.088586, 0.087716, 0.086853,
                 0.085996, 0.085146, 0.084303, 0.083467, 0.082637, 0.081814, 0.080998, 0.080188, 0.079384, 0.078587,
                 0.077797, 0.077013, 0.076235, 0.075463, 0.074698, 0.073939, 0.073186, 0.072440, 0.071700, 0.070966,
                 0.070238, 0.069516, 0.068800, 0.068090, 0.067386, 0.066688, 0.065996, 0.065309, 0.064629, 0.063954,
                 0.063285, 0.062622, 0.061965, 0.061313, 0.060667, 0.060026, 0.059392, 0.058762, 0.058138, 0.057520,
                 0.056907, 0.056299, 0.055697, 0.055100, 0.054508, 0.053922, 0.053341, 0.052765, 0.052194, 0.051629,
                 0.051068, 0.050513, 0.049962, 0.049417, 0.048876, 0.048341, 0.047810, 0.047284, 0.046764, 0.046247,
                 0.045736, 0.045230, 0.044728, 0.044231, 0.043738, 0.043250, 0.042767, 0.042288, 0.041814, 0.041344,
                 0.040879, 0.040418, 0.039961, 0.039509, 0.039061, 0.038618, 0.038178, 0.037743, 0.037313, 0.036886,
                 0.036463, 0.036045, 0.035631, 0.035220, 0.034814, 0.034412, 0.034014, 0.033619, 0.033229, 0.032842,
                 0.032460, 0.032081, 0.031706, 0.031334, 0.030966, 0.030603, 0.030242, 0.029886, 0.029533, 0.029183,
                 0.028837, 0.028495, 0.028156, 0.027821, 0.027489, 0.027160, 0.026835, 0.026513, 0.026195, 0.025879,
                 0.025567, 0.025259, 0.024953, 0.024651, 0.024352, 0.024056, 0.023763, 0.023474, 0.023187, 0.022903,
                 0.022623, 0.022345, 0.022071, 0.021799, 0.021530, 0.021264, 0.021001, 0.020741, 0.020484, 0.020229,
                 0.019977, 0.019728, 0.019482, 0.019238, 0.018997, 0.018758, 0.018523, 0.018289, 0.018059, 0.017831,
                 0.017605, 0.017382, 0.017161, 0.016943, 0.016728, 0.016514, 0.016304, 0.016095, 0.015889, 0.015685,
                 0.015484, 0.015284, 0.015087, 0.014893, 0.014700, 0.014510, 0.014321, 0.014135, 0.013952, 0.013770,
                 0.013590, 0.013413, 0.013237, 0.013064, 0.012892, 0.012723, 0.012555, 0.012389, 0.012226, 0.012064,
                 0.011904, 0.011746, 0.011590, 0.011436, 0.011284, 0.011133, 0.010984, 0.010837, 0.010692, 0.010548,
                 0.010407, 0.010266, 0.010128, 0.009991, 0.009856, 0.009722, 0.009591, 0.009460, 0.009332, 0.009204,
                 0.009079, 0.008955, 0.008832, 0.008711, 0.008592, 0.008474, 0.008357, 0.008242, 0.008128, 0.008016,
                 0.007905, 0.007795, 0.007687, 0.007580, 0.007474, 0.007370, 0.007267, 0.007166, 0.007065, 0.006966,
                 0.006868, 0.006772, 0.006676, 0.006582, 0.006489, 0.006397, 0.006307, 0.006217, 0.006129, 0.006042,
                 0.005956, 0.005871, 0.005787, 0.005704, 0.005623, 0.005542, 0.005462, 0.005384, 0.005306, 0.005230,
                 0.005154, 0.005080, 0.005006, 0.004933, 0.004862, 0.004791, 0.004721, 0.004652, 0.004585, 0.004518,
                 0.004451, 0.004386, 0.004322, 0.004258, 0.004195, 0.004134, 0.004073, 0.004012, 0.003953, 0.003894,
                 0.003837, 0.003780, 0.003723, 0.003668, 0.003613, 0.003559, 0.003506, 0.003453, 0.003402, 0.003351,
                 0.003300, 0.003250, 0.003201, 0.003153, 0.003105, 0.003058, 0.003012, 0.002966, 0.002921, 0.002877,
                 0.002833, 0.002790, 0.002747, 0.002705, 0.002664, 0.002623, 0.002582, 0.002543, 0.002504, 0.002465,
                 0.002427, 0.002389, 0.002352, 0.002316, 0.002280, 0.002245, 0.002210, 0.002175, 0.002141, 0.002108,
                 0.002075, 0.002042, 0.002010, 0.001979, 0.001948, 0.001917, 0.001887, 0.001857, 0.001828, 0.001799,
                 0.001770, 0.001742, 0.001715, 0.001687, 0.001661, 0.001634, 0.001608, 0.001582, 0.001557, 0.001532,
                 0.001508, 0.001483, 0.001459, 0.001436, 0.001413, 0.001390, 0.001368, 0.001345, 0.001324, 0.001302,
                 0.001281, 0.001260, 0.001240, 0.001220, 0.001200, 0.001180, 0.001161, 0.001142, 0.001123, 0.001105,
                 0.001086, 0.001069, 0.001051, 0.001034, 0.001017, 0.001000, 0.000983, 0.000967, 0.000951, 0.000935,
                 0.000919, 0.000904, 0.000889, 0.000874, 0.000860, 0.000845, 0.000831, 0.000817, 0.000803, 0.000790,
                 0.000777, 0.000764, 0.000751, 0.000738, 0.000726, 0.000713, 0.000701, 0.000689, 0.000678, 0.000666,
                 0.000655, 0.000643, 0.000633, 0.000622, 0.000611, 0.000601, 0.000590, 0.000580, 0.000570, 0.000560,
                 0.000551, 0.000541, 0.000532, 0.000523, 0.000514, 0.000505, 0.000496, 0.000487, 0.000479, 0.000471,
                 0.000462, 0.000454, 0.000446, 0.000439, 0.000431, 0.000423, 0.000416, 0.000409, 0.000401, 0.000394,
                 0.000387, 0.000381, 0.000374, 0.000367, 0.000361, 0.000354, 0.000348, 0.000342, 0.000336, 0.000330,
                 0.000324, 0.000318, 0.000312, 0.000307, 0.000301, 0.000296, 0.000291, 0.000285, 0.000280, 0.000275,
                 0.000270, 0.000265, 0.000261, 0.000256, 0.000251, 0.000247, 0.000242, 0.000238, 0.000233, 0.000229,
                 0.000225, 0.000221, 0.000217, 0.000213, 0.000209, 0.000205, 0.000201, 0.000198, 0.000194, 0.000191,
                 0.000187, 0.000184, 0.000180, 0.000177, 0.000174, 0.000170, 0.000167, 0.000164, 0.000161, 0.000158,
                 0.000155, 0.000152, 0.000149, 0.000147, 0.000144, 0.000141, 0.000139, 0.000136, 0.000133, 0.000131,
                 0.000128, 0.000126, 0.000124, 0.000121, 0.000119, 0.000117, 0.000114, 0.000112, 0.000110, 0.000108,
                 0.000106, 0.000104, 0.000102, 0.000100, 0.000098, 0.000096, 0.000094, 0.000093, 0.000091, 0.000089,
                 0.000087, 0.000086, 0.000084, 0.000082, 0.000081, 0.000079, 0.000078, 0.000076, 0.000075, 0.000073,
                 0.000072, 0.000071, 0.000069, 0.000068, 0.000066, 0.000065, 0.000064, 0.000063, 0.000061, 0.000060,
                 0.000059, 0.000058, 0.000057, 0.000056, 0.000055, 0.000053, 0.000052, 0.000051, 0.000050, 0.000049,
                 0.000048, 0.000047, 0.000046, 0.000046, 0.000045, 0.000044, 0.000043, 0.000042, 0.000041, 0.000040]
    fig = plt.figure(figsize=(16, 9))
    ax = fig.add_subplot(111)
    plt.xlim((0, 1.02))
    # plt.ylim((0, 1800))
    plt.ylabel(r"$f_{\Delta}$    ", fontsize=35, rotation=0)  # make it horizontal
    plt.xlabel(r"$\bar{\alpha}$", fontsize=30)
    plt.yticks(fontsize=25)
    plt.xticks(fontsize=25)

    mse_train = [f / 3072 for f in mse_train]
    mse_test  = [f / 3072 for f in mse_test]
    ax.plot(alpha_bar, mse_train, linestyle='-', linewidth=8, color='c',
            label=r"$f_{\Delta}$ value on training dataset")
    ax.plot(alpha_bar, mse_test, linestyle='--', linewidth=4, color='r',
            label=r"$f_{\Delta}$ value on testing dataset")
    ax.legend(fontsize=25, loc='upper center')

    plt.show()
    f_path = './configs/chart/mse_error_vs_alpha_bar.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file: {f_path}")
    plt.close()

def fid_compare_ddim_cifar10():
    fid_log = [21.1, 12.7, 9.6, 8.0, 5.5, 4.7]    # logSNR
    fid_lo2 = [15.2,  9.2, 7.4, 7.2, 4.7, 4.1]    # logSNR + VRG
    fid_qua = [14.0,  8.9, 7.1, 6.1, 4.8, 4.3]    # quadratic
    fid_qu2 = [11.9,  7.9, 6.2, 5.7, 4.3, 3.8]    # quadratic + VRG
    fid_uni = [16.8, 10.7, 8.3, 7.1, 4.8, 4.0]    # uniform
    fid_un2 = [11.1,  7.7, 6.1, 5.8, 4.4, 3.8]    # uniform + VRG
    steps = ['10', '15', '20', '25', '50', '100']
    fig = plt.figure(figsize=(16, 6))
    ax1 = fig.add_subplot(1, 3, 1)
    ax2 = fig.add_subplot(1, 3, 2)
    ax3 = fig.add_subplot(1, 3, 3)
    # plt.xlim((0, 1.02))
    # plt.ylim((0, 1800))
    axs = [ax1, ax2, ax3]
    fid_arr = [[fid_log, fid_lo2], [fid_qua, fid_qu2], [fid_uni, fid_un2]]
    lbl_arr = [[s, f"{s}+VRG"] for s in ['logSNR', 'quadratic', 'uniform']]
    ylb_arr = [r"FID      ", '', '']    # y label on the left
    xlb_arr = ['', r"step count", '']   # x label in the middle
    for ax, fids, lbs, ylb, xlb in zip(axs, fid_arr, lbl_arr, ylb_arr, xlb_arr):
        ax.set_ylabel(ylb, fontsize=25, rotation=0)  # make it horizontal
        ax.set_xlabel(xlb, fontsize=25)
        ax.tick_params('both', labelsize=20)
        ax.plot(steps, fids[0], linestyle='-', color='c', marker='o', label=lbs[0])
        ax.plot(steps, fids[1], linestyle='-', color='r', marker='s', label=lbs[1])
        ax.legend(fontsize=18, loc='upper right')
    # for
    fig.suptitle("Compare with DDIM on CIFAR10", fontsize=30)
    plt.show()
    f_path = './configs/chart/fid_ddim_cifar10.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file saved: {f_path}")
    plt.close()

def fid_compare_ddim_bedroom():
    fid_log = [46.2, 29.5, 23.1]    # logSNR
    fid_lo2 = [43.1, 27.0, 20.9]    # logSNR + VRG
    fid_qua = [35.1, 23.2, 19.0]    # quadratic
    fid_qu2 = [34.1, 22.7, 18.8]    # quadratic + VRG
    fid_uni = [20.1, 13.4, 11.0]    # uniform
    fid_un2 = [18.6, 12.2, 10.7]    # uniform + VRG
    steps = ['10', '15', '20']
    fig = plt.figure(figsize=(16, 6))
    ax1 = fig.add_subplot(1, 3, 1)
    ax2 = fig.add_subplot(1, 3, 2)
    ax3 = fig.add_subplot(1, 3, 3)
    # plt.xlim((0, 1.02))
    # plt.ylim((0, 1800))
    axs = [ax1, ax2, ax3]
    fid_arr = [[fid_log, fid_lo2], [fid_qua, fid_qu2], [fid_uni, fid_un2]]
    lbl_arr = [[s, f"{s}+VRG"] for s in ['logSNR', 'quadratic', 'uniform']]
    ylb_arr = [r"FID      ", '', '']    # y label on the left
    xlb_arr = ['', r"step count", '']   # x label in the middle
    for ax, fids, lbs, ylb, xlb in zip(axs, fid_arr, lbl_arr, ylb_arr, xlb_arr):
        ax.set_ylabel(ylb, fontsize=25, rotation=0)  # make it horizontal
        ax.set_xlabel(xlb, fontsize=25)
        ax.tick_params('both', labelsize=20)
        ax.plot(steps, fids[0], linestyle='-', color='c', marker='o', label=lbs[0])
        ax.plot(steps, fids[1], linestyle='-', color='r', marker='s', label=lbs[1])
        ax.legend(fontsize=18, loc='upper right')
    # for
    fig.suptitle("Compare with DDIM on LSUN-bedroom", fontsize=30)
    plt.show()
    f_path = './configs/chart/fid_ddim_bedroom.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file saved: {f_path}")
    plt.close()

def fid_compare_ddim_celeba():
    fid_log = [18.1, 12.1, 9.7]     # logSNR
    fid_lo2 = [15.9, 10.8, 8.7]     # logSNR + VRG
    fid_qua = [28.9, 19.4, 14.5]    # quadratic
    fid_qu2 = [27.0, 16.2, 11.9]    # quadratic + VRG
    fid_uni = [15.4, 9.6, 7.1]      # uniform
    fid_un2 = [14.7, 9.2, 7.0]      # uniform + VRG
    steps = ['10', '15', '20']
    fig = plt.figure(figsize=(16, 6))
    ax1 = fig.add_subplot(1, 3, 1)
    ax2 = fig.add_subplot(1, 3, 2)
    ax3 = fig.add_subplot(1, 3, 3)
    # plt.xlim((0, 1.02))
    # plt.ylim((0, 1800))
    axs = [ax1, ax2, ax3]
    fid_arr = [[fid_log, fid_lo2], [fid_qua, fid_qu2], [fid_uni, fid_un2]]
    lbl_arr = [[s, f"{s}+VRG"] for s in ['logSNR', 'quadratic', 'uniform']]
    ylb_arr = [r"FID      ", '', '']    # y label on the left
    xlb_arr = ['', r"step count", '']   # x label in the middle
    for ax, fids, lbs, ylb, xlb in zip(axs, fid_arr, lbl_arr, ylb_arr, xlb_arr):
        ax.set_ylabel(ylb, fontsize=25, rotation=0)  # make it horizontal
        ax.set_xlabel(xlb, fontsize=25)
        ax.tick_params('both', labelsize=20)
        ax.plot(steps, fids[0], linestyle='-', color='c', marker='o', label=lbs[0])
        ax.plot(steps, fids[1], linestyle='-', color='r', marker='s', label=lbs[1])
        ax.legend(fontsize=18, loc='upper right')
    # for
    fig.suptitle("Compare with DDIM on CelebA", fontsize=30)
    plt.show()
    f_path = './configs/chart/fid_ddim_celeba.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file saved: {f_path}")
    plt.close()

def fid_compare_pndm_cifar10():
    fid_s  = [22.192, 9.7003, 6.8920, 5.6528]    # S-PNDM
    fid_s2 = [17.714, 6.7580, 4.6959, 4.0628]    # S-PNDM + VRG
    fid_f  = [18.623, 8.3909, 5.5028, 4.6607]    # F-PNDM
    fid_f2 = [12.465, 4.8597, 3.6508, 3.6243]    # F-PNDM + VRG
    steps = ['5', '10', '15', '20']
    fig = plt.figure(figsize=(16, 8))
    ax1 = fig.add_subplot(1, 2, 1)
    ax2 = fig.add_subplot(1, 2, 2)
    ax1.set_ylim((0, 23))
    ax2.set_ylim((0, 23))
    # plt.xlim((0, 1.02))
    # plt.ylim((0, 1800))
    axs = [ax1, ax2]
    fid_arr = [[fid_s, fid_s2], [fid_f, fid_f2]]
    lbl_arr = [[s, f"{s}+VRG"] for s in ['S-PNDM', 'F-PNDM']]
    for ax, fids, lbs in zip(axs, fid_arr, lbl_arr):
        ax.tick_params('both', labelsize=20)
        ax.plot(steps, fids[0], linestyle='-', color='c', marker='o', label=lbs[0])
        ax.plot(steps, fids[1], linestyle='-', color='r', marker='s', label=lbs[1])
        ax.legend(fontsize=20, loc='upper right')
    # for
    fig.supxlabel('step count', fontsize=25)
    fig.supylabel('   FID', fontsize=25, rotation=0)
    fig.suptitle("Compare with PNDM on CIFAR10", fontsize=30)
    plt.show()
    f_path = './configs/chart/fid_pndm_cifar10.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file saved: {f_path}")
    plt.close()

def fid_compare_splitnm_imagenet():
    fid_c64_old  = [220.4, 151.2, 134.4, 116.7, 46.97]  # conditional 64*64, original trajectory
    fid_c64_new  = [28.19, 13.57, 10.64, 9.286, 6.252]  # conditional 64*64, new trajectory
    fid_c128_old = [73.06, 59.44, 51.05, 51.33, 53.00]
    fid_c128_new = [71.79, 57.55, 50.53, 50.76, 52.89]
    steps = ['10', '15', '20', '25', '50']
    fig = plt.figure(figsize=(16, 8))
    ax1 = fig.add_subplot(1, 2, 1)
    ax2 = fig.add_subplot(1, 2, 2)
    axs = [ax1, ax2]
    fid_arr = [[fid_c64_old, fid_c64_new], [fid_c128_old, fid_c128_new]]
    ttl_arr = ['image size: 64*64', 'image size: 128*128']
    lbl_arr = ['STSP', 'STSP+VRG']
    for ax, fids, ttl in zip(axs, fid_arr, ttl_arr):
        ax.tick_params('both', labelsize=20)
        ax.plot(steps, fids[0], linestyle='-', color='c', marker='o')
        ax.plot(steps, fids[1], linestyle='-', color='r', marker='s')
        ax.legend(lbl_arr, fontsize=20, loc='upper right')
        ax.set_title(ttl, fontsize=25)
    # for
    fig.supylabel('  FID', fontsize=25, rotation=0)  # make it horizontal
    fig.supxlabel('step count', fontsize=25)
    fig.suptitle("Compare with SplitNM on ImageNet", fontsize=30)
    plt.show()
    f_path = './configs/chart/fid_splitnm_imagenet.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file saved: {f_path}")
    plt.close()

def fig_trajectory_compare_all3():
    fig = plt.figure(figsize=(12, 7))
    ax_arr = fig.add_subplot(311), fig.add_subplot(312), fig.add_subplot(313)
    ab_log_ori = [0.999309, 0.995248, 0.968069, 0.814417, 0.388457, 0.084202, 0.013133, 0.001922, 0.000278, 0.000040]
    ts_log_ori = [0.003, 0.016, 0.051, 0.138, 0.302, 0.492, 0.652, 0.784, 0.898, 0.998]
    ab_log_new = [0.998924, 0.995163, 0.977908, 0.832462, 0.405384, 0.091924, 0.015257, 0.002386, 0.000370, 0.000057]
    ts_log_new = [0.005, 0.017, 0.042, 0.130, 0.295, 0.483, 0.641, 0.771, 0.882, 0.981]
    ab_qua_ori = [0.995807, 0.970207, 0.889866, 0.723901, 0.481753, 0.236788, 0.075947, 0.013741, 0.001185, 0.000040]
    ts_qua_ori = [0.015, 0.049, 0.102, 0.174, 0.265, 0.374, 0.502, 0.649, 0.814, 0.998]
    ab_qua_new = [0.996924, 0.981219, 0.909756, 0.749162, 0.506046, 0.253784, 0.083935, 0.016025, 0.001543, 0.000068]
    ts_qua_new = [0.012, 0.038, 0.091, 0.164, 0.255, 0.365, 0.492, 0.637, 0.798, 0.972]
    ab_uni_ori = [0.895328, 0.656884, 0.394732, 0.194200, 0.078190, 0.025754, 0.006936, 0.001527, 0.000274, 0.000040]
    ts_uni_ori = [0.099, 0.199, 0.299, 0.399, 0.499, 0.599, 0.699, 0.799, 0.899, 0.998]
    ab_uni_new = [0.905291, 0.673222, 0.411267, 0.206440, 0.085181, 0.028907, 0.008075, 0.001858, 0.000353, 0.000055]
    ts_uni_new = [0.094, 0.193, 0.292, 0.391, 0.490, 0.589, 0.688, 0.786, 0.885, 0.983]
    ab_all = [0.999900, 0.999780, 0.999640, 0.999481, 0.999301, 0.999102, 0.998882, 0.998643, 0.998384, 0.998105,
              0.997807, 0.997488, 0.997150, 0.996792, 0.996414, 0.996017, 0.995600, 0.995163, 0.994707, 0.994231,
              0.993735, 0.993220, 0.992686, 0.992131, 0.991558, 0.990965, 0.990353, 0.989721, 0.989070, 0.988400,
              0.987710, 0.987002, 0.986274, 0.985527, 0.984761, 0.983976, 0.983172, 0.982349, 0.981507, 0.980646,
              0.979767, 0.978869, 0.977952, 0.977016, 0.976062, 0.975090, 0.974099, 0.973089, 0.972062, 0.971016,
              0.969951, 0.968869, 0.967768, 0.966650, 0.965514, 0.964359, 0.963187, 0.961997, 0.960789, 0.959564,
              0.958321, 0.957061, 0.955783, 0.954488, 0.953176, 0.951846, 0.950500, 0.949136, 0.947756, 0.946358,
              0.944944, 0.943513, 0.942065, 0.940601, 0.939121, 0.937624, 0.936110, 0.934581, 0.933035, 0.931474,
              0.929896, 0.928303, 0.926694, 0.925069, 0.923428, 0.921773, 0.920101, 0.918415, 0.916713, 0.914996,
              0.913264, 0.911517, 0.909756, 0.907979, 0.906188, 0.904383, 0.902563, 0.900729, 0.898880, 0.897018,
              0.895141, 0.893251, 0.891347, 0.889429, 0.887497, 0.885552, 0.883594, 0.881622, 0.879637, 0.877639,
              0.875629, 0.873605, 0.871569, 0.869520, 0.867458, 0.865384, 0.863298, 0.861200, 0.859089, 0.856967,
              0.854832, 0.852687, 0.850529, 0.848360, 0.846180, 0.843988, 0.841785, 0.839572, 0.837347, 0.835112,
              0.832865, 0.830609, 0.828342, 0.826064, 0.823777, 0.821479, 0.819171, 0.816854, 0.814527, 0.812190,
              0.809844, 0.807488, 0.805123, 0.802750, 0.800367, 0.797975, 0.795574, 0.793165, 0.790747, 0.788321,
              0.785887, 0.783444, 0.780994, 0.778536, 0.776069, 0.773596, 0.771114, 0.768626, 0.766130, 0.763626,
              0.761116, 0.758599, 0.756075, 0.753545, 0.751008, 0.748464, 0.745914, 0.743358, 0.740797, 0.738229,
              0.735655, 0.733075, 0.730490, 0.727900, 0.725304, 0.722703, 0.720097, 0.717486, 0.714871, 0.712250,
              0.709625, 0.706995, 0.704362, 0.701724, 0.699081, 0.696435, 0.693785, 0.691131, 0.688474, 0.685813,
              0.683149, 0.680481, 0.677811, 0.675137, 0.672461, 0.669782, 0.667099, 0.664415, 0.661728, 0.659039,
              0.656347, 0.653654, 0.650958, 0.648261, 0.645561, 0.642861, 0.640158, 0.637455, 0.634750, 0.632044,
              0.629336, 0.626628, 0.623919, 0.621210, 0.618500, 0.615789, 0.613078, 0.610366, 0.607655, 0.604943,
              0.602232, 0.599520, 0.596809, 0.594098, 0.591388, 0.588678, 0.585969, 0.583261, 0.580554, 0.577847,
              0.575142, 0.572438, 0.569735, 0.567034, 0.564334, 0.561636, 0.558940, 0.556245, 0.553552, 0.550861,
              0.548173, 0.545486, 0.542802, 0.540120, 0.537441, 0.534764, 0.532090, 0.529419, 0.526751, 0.524085,
              0.521423, 0.518764, 0.516108, 0.513455, 0.510806, 0.508160, 0.505518, 0.502880, 0.500245, 0.497614,
              0.494987, 0.492364, 0.489745, 0.487130, 0.484520, 0.481914, 0.479312, 0.476715, 0.474122, 0.471534,
              0.468951, 0.466372, 0.463799, 0.461230, 0.458667, 0.456108, 0.453555, 0.451007, 0.448464, 0.445927,
              0.443395, 0.440869, 0.438348, 0.435833, 0.433324, 0.430821, 0.428324, 0.425832, 0.423346, 0.420867,
              0.418394, 0.415926, 0.413466, 0.411011, 0.408563, 0.406121, 0.403686, 0.401257, 0.398835, 0.396420,
              0.394011, 0.391609, 0.389214, 0.386826, 0.384445, 0.382071, 0.379704, 0.377344, 0.374991, 0.372645,
              0.370307, 0.367976, 0.365652, 0.363335, 0.361027, 0.358725, 0.356431, 0.354145, 0.351866, 0.349595,
              0.347331, 0.345076, 0.342828, 0.340588, 0.338356, 0.336131, 0.333915, 0.331706, 0.329506, 0.327314,
              0.325129, 0.322953, 0.320785, 0.318625, 0.316473, 0.314329, 0.312194, 0.310067, 0.307949, 0.305838,
              0.303736, 0.301643, 0.299558, 0.297481, 0.295413, 0.293353, 0.291302, 0.289259, 0.287225, 0.285200,
              0.283183, 0.281174, 0.279175, 0.277184, 0.275201, 0.273228, 0.271263, 0.269307, 0.267359, 0.265420,
              0.263490, 0.261569, 0.259657, 0.257754, 0.255859, 0.253973, 0.252096, 0.250228, 0.248368, 0.246518,
              0.244676, 0.242844, 0.241020, 0.239205, 0.237399, 0.235602, 0.233814, 0.232034, 0.230264, 0.228503,
              0.226750, 0.225007, 0.223272, 0.221546, 0.219829, 0.218121, 0.216422, 0.214732, 0.213051, 0.211379,
              0.209716, 0.208061, 0.206416, 0.204779, 0.203152, 0.201533, 0.199923, 0.198322, 0.196730, 0.195146,
              0.193572, 0.192006, 0.190450, 0.188902, 0.187363, 0.185832, 0.184311, 0.182798, 0.181294, 0.179799,
              0.178313, 0.176835, 0.175366, 0.173906, 0.172454, 0.171011, 0.169577, 0.168152, 0.166735, 0.165326,
              0.163927, 0.162535, 0.161153, 0.159779, 0.158413, 0.157056, 0.155708, 0.154368, 0.153036, 0.151713,
              0.150399, 0.149092, 0.147794, 0.146505, 0.145224, 0.143951, 0.142686, 0.141430, 0.140182, 0.138942,
              0.137710, 0.136487, 0.135271, 0.134064, 0.132865, 0.131674, 0.130491, 0.129316, 0.128149, 0.126990,
              0.125839, 0.124696, 0.123561, 0.122433, 0.121314, 0.120202, 0.119098, 0.118002, 0.116914, 0.115833,
              0.114760, 0.113695, 0.112637, 0.111587, 0.110544, 0.109509, 0.108482, 0.107462, 0.106449, 0.105444,
              0.104447, 0.103456, 0.102473, 0.101497, 0.100529, 0.099568, 0.098614, 0.097667, 0.096727, 0.095794,
              0.094869, 0.093950, 0.093039, 0.092134, 0.091237, 0.090346, 0.089463, 0.088586, 0.087716, 0.086853,
              0.085996, 0.085146, 0.084303, 0.083467, 0.082637, 0.081814, 0.080998, 0.080188, 0.079384, 0.078587,
              0.077797, 0.077013, 0.076235, 0.075463, 0.074698, 0.073939, 0.073186, 0.072440, 0.071700, 0.070966,
              0.070238, 0.069516, 0.068800, 0.068090, 0.067386, 0.066688, 0.065996, 0.065309, 0.064629, 0.063954,
              0.063285, 0.062622, 0.061965, 0.061313, 0.060667, 0.060026, 0.059392, 0.058762, 0.058138, 0.057520,
              0.056907, 0.056299, 0.055697, 0.055100, 0.054508, 0.053922, 0.053341, 0.052765, 0.052194, 0.051629,
              0.051068, 0.050513, 0.049962, 0.049417, 0.048876, 0.048341, 0.047810, 0.047284, 0.046764, 0.046247,
              0.045736, 0.045230, 0.044728, 0.044231, 0.043738, 0.043250, 0.042767, 0.042288, 0.041814, 0.041344,
              0.040879, 0.040418, 0.039961, 0.039509, 0.039061, 0.038618, 0.038178, 0.037743, 0.037313, 0.036886,
              0.036463, 0.036045, 0.035631, 0.035220, 0.034814, 0.034412, 0.034014, 0.033619, 0.033229, 0.032842,
              0.032460, 0.032081, 0.031706, 0.031334, 0.030966, 0.030603, 0.030242, 0.029886, 0.029533, 0.029183,
              0.028837, 0.028495, 0.028156, 0.027821, 0.027489, 0.027160, 0.026835, 0.026513, 0.026195, 0.025879,
              0.025567, 0.025259, 0.024953, 0.024651, 0.024352, 0.024056, 0.023763, 0.023474, 0.023187, 0.022903,
              0.022623, 0.022345, 0.022071, 0.021799, 0.021530, 0.021264, 0.021001, 0.020741, 0.020484, 0.020229,
              0.019977, 0.019728, 0.019482, 0.019238, 0.018997, 0.018758, 0.018523, 0.018289, 0.018059, 0.017831,
              0.017605, 0.017382, 0.017161, 0.016943, 0.016728, 0.016514, 0.016304, 0.016095, 0.015889, 0.015685,
              0.015484, 0.015284, 0.015087, 0.014893, 0.014700, 0.014510, 0.014321, 0.014135, 0.013952, 0.013770,
              0.013590, 0.013413, 0.013237, 0.013064, 0.012892, 0.012723, 0.012555, 0.012389, 0.012226, 0.012064,
              0.011904, 0.011746, 0.011590, 0.011436, 0.011284, 0.011133, 0.010984, 0.010837, 0.010692, 0.010548,
              0.010407, 0.010266, 0.010128, 0.009991, 0.009856, 0.009722, 0.009591, 0.009460, 0.009332, 0.009204,
              0.009079, 0.008955, 0.008832, 0.008711, 0.008592, 0.008474, 0.008357, 0.008242, 0.008128, 0.008016,
              0.007905, 0.007795, 0.007687, 0.007580, 0.007474, 0.007370, 0.007267, 0.007166, 0.007065, 0.006966,
              0.006868, 0.006772, 0.006676, 0.006582, 0.006489, 0.006397, 0.006307, 0.006217, 0.006129, 0.006042,
              0.005956, 0.005871, 0.005787, 0.005704, 0.005623, 0.005542, 0.005462, 0.005384, 0.005306, 0.005230,
              0.005154, 0.005080, 0.005006, 0.004933, 0.004862, 0.004791, 0.004721, 0.004652, 0.004585, 0.004518,
              0.004451, 0.004386, 0.004322, 0.004258, 0.004195, 0.004134, 0.004073, 0.004012, 0.003953, 0.003894,
              0.003837, 0.003780, 0.003723, 0.003668, 0.003613, 0.003559, 0.003506, 0.003453, 0.003402, 0.003351,
              0.003300, 0.003250, 0.003201, 0.003153, 0.003105, 0.003058, 0.003012, 0.002966, 0.002921, 0.002877,
              0.002833, 0.002790, 0.002747, 0.002705, 0.002664, 0.002623, 0.002582, 0.002543, 0.002504, 0.002465,
              0.002427, 0.002389, 0.002352, 0.002316, 0.002280, 0.002245, 0.002210, 0.002175, 0.002141, 0.002108,
              0.002075, 0.002042, 0.002010, 0.001979, 0.001948, 0.001917, 0.001887, 0.001857, 0.001828, 0.001799,
              0.001770, 0.001742, 0.001715, 0.001687, 0.001661, 0.001634, 0.001608, 0.001582, 0.001557, 0.001532,
              0.001508, 0.001483, 0.001459, 0.001436, 0.001413, 0.001390, 0.001368, 0.001345, 0.001324, 0.001302,
              0.001281, 0.001260, 0.001240, 0.001220, 0.001200, 0.001180, 0.001161, 0.001142, 0.001123, 0.001105,
              0.001086, 0.001069, 0.001051, 0.001034, 0.001017, 0.001000, 0.000983, 0.000967, 0.000951, 0.000935,
              0.000919, 0.000904, 0.000889, 0.000874, 0.000860, 0.000845, 0.000831, 0.000817, 0.000803, 0.000790,
              0.000777, 0.000764, 0.000751, 0.000738, 0.000726, 0.000713, 0.000701, 0.000689, 0.000678, 0.000666,
              0.000655, 0.000643, 0.000633, 0.000622, 0.000611, 0.000601, 0.000590, 0.000580, 0.000570, 0.000560,
              0.000551, 0.000541, 0.000532, 0.000523, 0.000514, 0.000505, 0.000496, 0.000487, 0.000479, 0.000471,
              0.000462, 0.000454, 0.000446, 0.000439, 0.000431, 0.000423, 0.000416, 0.000409, 0.000401, 0.000394,
              0.000387, 0.000381, 0.000374, 0.000367, 0.000361, 0.000354, 0.000348, 0.000342, 0.000336, 0.000330,
              0.000324, 0.000318, 0.000312, 0.000307, 0.000301, 0.000296, 0.000291, 0.000285, 0.000280, 0.000275,
              0.000270, 0.000265, 0.000261, 0.000256, 0.000251, 0.000247, 0.000242, 0.000238, 0.000233, 0.000229,
              0.000225, 0.000221, 0.000217, 0.000213, 0.000209, 0.000205, 0.000201, 0.000198, 0.000194, 0.000191,
              0.000187, 0.000184, 0.000180, 0.000177, 0.000174, 0.000170, 0.000167, 0.000164, 0.000161, 0.000158,
              0.000155, 0.000152, 0.000149, 0.000147, 0.000144, 0.000141, 0.000139, 0.000136, 0.000133, 0.000131,
              0.000128, 0.000126, 0.000124, 0.000121, 0.000119, 0.000117, 0.000114, 0.000112, 0.000110, 0.000108,
              0.000106, 0.000104, 0.000102, 0.000100, 0.000098, 0.000096, 0.000094, 0.000093, 0.000091, 0.000089,
              0.000087, 0.000086, 0.000084, 0.000082, 0.000081, 0.000079, 0.000078, 0.000076, 0.000075, 0.000073,
              0.000072, 0.000071, 0.000069, 0.000068, 0.000066, 0.000065, 0.000064, 0.000063, 0.000061, 0.000060,
              0.000059, 0.000058, 0.000057, 0.000056, 0.000055, 0.000053, 0.000052, 0.000051, 0.000050, 0.000049,
              0.000048, 0.000047, 0.000046, 0.000046, 0.000045, 0.000044, 0.000043, 0.000042, 0.000041, 0.000040]
    ts_all = list(range(len(ab_all)))
    ts_all = [(float(i))/1000.0 for i in ts_all]
    abo_arr = [ab_log_ori, ab_qua_ori, ab_uni_ori]
    tso_arr = [ts_log_ori, ts_qua_ori, ts_uni_ori]
    abn_arr = [ab_log_new, ab_qua_new, ab_uni_new]
    tsn_arr = [ts_log_new, ts_qua_new, ts_uni_new]
    ttl_arr = ['logSNR', 'quadratic', 'uniform']
    for ax, ab_ori, ts_ori, ab_new, ts_new, ttl in zip(ax_arr, abo_arr, tso_arr, abn_arr, tsn_arr, ttl_arr):
        ax.tick_params('both', labelsize=12)
        ax.set_xlim((0, 1.02))
        ax.set_ylim((-0.05, 1.05))
        ax.plot(ts_ori, ab_ori, 'o', ms=6, color='b')
        ax.plot(ts_new, ab_new, '*', ms=6, color='red')
        ax.plot(ts_all, ab_all, '--', color='green', linewidth=1)
        # why duplicate: the ax legend only follow the plot order, but we want marker cover line.
        ax.plot(ts_ori, ab_ori, 'o', ms=6, color='b')
        ax.plot(ts_new, ab_new, '*', ms=6, color='red')
        # add text. annotation for dot and star.
        # ax.plot([0.27], [0.855], 'o', ms=10, color='blue')
        # ax.text(0.29, 0.84, ': original trajectory', size=15)
        # ax.plot([0.27], [0.755], '*', ms=16, color='red')
        # ax.text(0.29, 0.74, ': improved trajectory', size=15)
        ax.legend(['Baseline trajectory', 'Optimized trajectory'], fontsize=12, loc='upper right')
        ax.text(0.45, 0.9, ttl, size=15)
    # for
    fig.supylabel(r"      $\bar{\alpha}$", fontsize=20, rotation=0)  # make it horizontal
    fig.supxlabel('timestep t', fontsize=15)
    plt.show()
    f_path = './configs/chart/abc_o1_s10_all3.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"Saved: {f_path}")
    plt.close()

    fig = plt.figure(figsize=(7, 5))  # ------------------------- sup
    ax = fig.add_subplot(111)
    ab_log_ori = ab_log_ori[:3]
    ts_log_ori = ts_log_ori[:3]
    ab_log_new = ab_log_new[:3]
    ts_log_new = ts_log_new[:3]
    ab_last = min(ab_log_ori[-1], ab_log_new[-1])
    idx = 0
    while ab_all[idx] >= ab_last:
        idx += 1
    ab_all = ab_all[:idx+1]
    ts_all = ts_all[:idx+1]
    ab_log_ori = [f+0.0004 for f in ab_log_ori]  # small adjustment based on observation
    ax.tick_params('both', labelsize=12)
    ax.plot(ts_log_ori, ab_log_ori, 'o', ms=6, color='b')
    ax.plot(ts_log_new, ab_log_new, '*', ms=6, color='red')
    ax.plot(ts_all, ab_all, '--', color='green', linewidth=1)
    # why duplicate: the ax legend only follow the plot order, but we want marker cover line.
    ax.plot(ts_log_ori, ab_log_ori, 'o', ms=6, color='b')
    ax.plot(ts_log_new, ab_log_new, '*', ms=6, color='red')
    ax.legend(['Baseline trajectory', 'Optimized trajectory'], fontsize=12, loc='upper right')
    fig.supylabel(r"$\bar{\alpha}$        ", fontsize=20, rotation=0)  # make it horizontal
    fig.supxlabel('timestep t', fontsize=15)
    plt.show()
    f_path = './configs/chart/abc_o1_s10_all3_sup.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"Saved: {f_path}")
    plt.close()

def discretization_error_vs_prediction_error():
    """
    discretization error, prediction error.
    wde: with discretization error.
    """
    def read_floats_from_file(f):
        x_arr, y_arr = [], []
        with open(f, 'r') as fptr:
            lines = fptr.readlines()
            for line in lines:
                line = line.strip()
                if line.startswith('#') or line == '': continue
                x, y = line.split()
                x, y = float(x), float(y)
                x_arr.append(x)
                y_arr.append(y)
            # for
        # with
        return y_arr, x_arr

    x04, y04 = read_floats_from_file("./configs/2023-06-14_chart_trajectory/fig_trajectory_wde_04.txt")
    x10, y10 = read_floats_from_file("./configs/2023-06-14_chart_trajectory/fig_trajectory_wde_10.txt")
    x1k, y1k = read_floats_from_file("./configs/2023-06-14_chart_trajectory/fig_trajectory_wde_1000.txt")
    f_path = './configs/2023-06-14_chart_trajectory/fig_trajectory_with_diff_errors.png'
    fig = plt.figure(figsize=(16, 8))
    ax = fig.add_subplot(1, 1, 1)
    ax.tick_params('both', labelsize=25)
    ax.plot(x1k, y1k, linestyle='-', color='r')
    ax.plot(x10, y10, linestyle='-', color='b', marker='o', ms=6)
    ax.plot(x04, y04, linestyle='-', color='c', marker='o', ms=9)

    # arrow
    def add_arrow():
        tmp_fn = lambda xx, yy, idx, r: (xx[idx] * r + xx[idx-1] * (1 - r), yy[idx] * r + yy[idx-1] * (1 - r))
        arrow_props = dict(arrowstyle="->", color='c', lw=2.5)
        m, fm = tmp_fn(x04, y04, 2, 0.91)
        n, fn = tmp_fn(x04, y04, 2, 0.99)
        ax.annotate("", xy=(n, fn), xytext=(m, fm), arrowprops=arrow_props, va='center')
        m, fm = tmp_fn(x04, y04, 3, 0.91)
        n, fn = tmp_fn(x04, y04, 3, 0.99)
        ax.annotate("", xy=(n, fn), xytext=(m, fm), arrowprops=arrow_props, va='center')
        m, fm = tmp_fn(x04, y04, 4, 0.91)
        n, fn = tmp_fn(x04, y04, 4, 0.99)
        ax.annotate("", xy=(n, fn), xytext=(m, fm), arrowprops=arrow_props, va='center')
        arrow_props['color'] = 'b'
        m, fm = tmp_fn(x10, y10, 2, 0.91)
        n, fn = tmp_fn(x10, y10, 2, 0.99)
        ax.annotate("", xy=(n, fn), xytext=(m, fm), arrowprops=arrow_props, va='center')
        m, fm = tmp_fn(x10, y10, 3, 0.91)
        n, fn = tmp_fn(x10, y10, 3, 0.99)
        ax.annotate("", xy=(n, fn), xytext=(m, fm), arrowprops=arrow_props, va='center')
        m, fm = tmp_fn(x10, y10, 4, 0.91)
        n, fn = tmp_fn(x10, y10, 4, 0.99)
        ax.annotate("", xy=(n, fn), xytext=(m, fm), arrowprops=arrow_props, va='center')
        tmp_fn = lambda xx, yy, idx, r: (xx[idx] * r + xx[idx - 50] * (1 - r), yy[idx] * r + yy[idx - 50] * (1 - r))
        arrow_props['color'] = 'r'
        m, fm = tmp_fn(x1k, y1k, 400, 0.91)
        n, fn = tmp_fn(x1k, y1k, 400, 0.99)
        ax.annotate("", xy=(n, fn), xytext=(m, fm), arrowprops=arrow_props, va='center')
        m, fm = tmp_fn(x1k, y1k, 666, 0.91)
        n, fn = tmp_fn(x1k, y1k, 666, 0.99)
        ax.annotate("", xy=(n, fn), xytext=(m, fm), arrowprops=arrow_props, va='center')
        m, fm = tmp_fn(x1k, y1k, 977, 0.91)
        n, fn = tmp_fn(x1k, y1k, 977, 0.99)
        ax.annotate("", xy=(n, fn), xytext=(m, fm), arrowprops=arrow_props, va='center')
    # add_arrow()

    ax.plot(x10, y10, linestyle='-', color='b', marker='o', ms=6)  # extra plot. make such lines in front
    ax.plot(x1k, y1k, linestyle='-', color='r')
    legends = ['Ideal continuous trajectory',
               'Four-step trajectory with discretization error',
               'Four-step trajectory with discretization and prediction error']
    ax.legend(legends, fontsize=20, loc='upper right')
    ax.set_title(f"Data value Comparison by different trajectories", fontsize=25)
    ax.set_xlabel(r"$x_t[a]$",  fontsize=25)
    ax.set_ylabel(r"$x_t[b]$        ",  fontsize=25, rotation=0)
    ax.set_ylim((0.1, 1.0))

    # fig.supylabel('  FID', fontsize=25, rotation=0)  # make it horizontal
    # fig.supxlabel('step count', fontsize=25)
    # fig.suptitle("Compare with SplitNM on ImageNet", fontsize=30)
    plt.show()
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file saved: {f_path}")
    plt.close()

def prediction_error_distribution():
    """ distribution of delta between predicted noise and ground truth noise """
    predefined_bins = 200

    def read_floats_from_file(f):
        x_arr = []
        with open(f, 'r') as fptr:
            lines = fptr.readlines()
            for line in lines:
                line = line.strip()
                if line.startswith('#') or line == '': continue
                f_tmp = float(line)
                x_arr.append(f_tmp)
            # for
        # with
        return x_arr

    def set_plt_ui(d):
        plt.tick_params('both', labelsize=25)
        # plt.title(r"Distribution of prediction error", fontsize=25)
        if d == 1:
            x_str = f"$1$-$st$ dimension of $\\epsilon_\\theta(x_t) - \\epsilon(x_t)$"
        elif d == 2:
            x_str = f"$2$-$nd$ dimension of $\\epsilon_\\theta(x_t) - \\epsilon(x_t)$"
        elif d == 3:
            x_str = f"$3$-$rd$ dimension of $\\epsilon_\\theta(x_t) - \\epsilon(x_t)$"
        else:
            x_str = f"${d}$-$th$ dimension of $\\epsilon_\\theta(x_t) - \\epsilon(x_t)$"
        plt.xlabel(x_str, fontsize=28)
        plt.ylabel("Frequency", fontsize=28)
        plt.legend(fontsize=25, loc='upper left')

    # ts_all = [0, 99, 199, 299, 399, 499, 599, 699, 799, 899, 999]
    ts_list_list = [
        [0, 99, 199],
        [399, 499, 599],
        [799, 899, 999]
    ]
    dim = 0
    for ts_list in ts_list_list:
        fig = plt.figure(figsize=(12, 6))
        # ax = fig.add_subplot(1, 1, 1)
        bins = predefined_bins
        for ts in ts_list:
            x = read_floats_from_file(f"./output0_lostats/dim{dim:04d}_ts{ts:03d}.txt")
            if isinstance(bins, int):
                std = np.std(x)
                bins = np.linspace(-std * 3, std * 3, num=bins+1, endpoint=True)
            n, bins, patches = plt.hist(x, bins=bins, histtype='step', label=f"t={ts + 1}")
        # for
        set_plt_ui(dim+1)
        f_path = f"./output0_lostats/fig_delta_distribution_dim{dim:04d}_{ts_list[0]:03d}-{ts_list[-1]:03d}.png"
        fig.savefig(f_path, bbox_inches='tight')
        print(f"saved file: {f_path}")
        plt.close()
    # for

    # for ts in ts_all:
    #     fig = plt.figure(figsize=(12, 8))
    #     ax = fig.add_subplot(1, 1, 1)
    #     x = read_floats_from_file(f"./output0_lostats/ts{ts:03d}.txt")
    #     std = np.std(x)
    #     bins = np.linspace(-std * 3, std * 3, num=predefined_bins+1, endpoint=True)
    #     plt.hist(x, bins=bins, histtype='step', label=f"timestep t={ts + 1}")
    #     set_plt_ui()
    #     f_path = f"./output0_lostats/fig_delta_distribution_ts{ts:03d}.png"
    #     # fig.savefig(f_path, bbox_inches='tight')
    #     fig.savefig(f_path)
    #     print(f"saved file: {f_path}")
    #     plt.close()
    # # for

def ablation_ddim():
    lp_arr = [0.0, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.35, 0.4]
    legend_arr = ["logSNR", "quadratic", "uniform"]

    def draw_fig(snr_arr, qua_arr, uni_arr, lambda_s):
        fig = plt.figure(figsize=(12, 8))
        ax = fig.add_subplot(1, 1, 1)
        ax.tick_params('both', labelsize=25)
        ax.plot(lp_arr, snr_arr, marker='o')
        ax.plot(lp_arr, qua_arr, marker='o')
        ax.plot(lp_arr, uni_arr, marker='o')
        ax.legend(legend_arr, fontsize=25, loc=(0.18, 0.73))
        ax.set_title(f"FID by different $lp$ ($\\lambda={lambda_s}$)", fontsize=25)
        ax.set_ylabel('FID      ', fontsize=28, rotation=0)  # make it horizontal
        ax.set_xlabel('$lp$', fontsize=28)
        ax.set_ylim((10, 22))
        f_path = f"./configs/chart/fig_ablation_ddim_lambda{lambda_s}.png"
        fig.savefig(f_path, bbox_inches='tight')  #
        print(f"file saved: {f_path}")
        plt.close()

    fid_snr_arr = [21.087, 18.822, 16.812, 14.250, 13.359, 13.385, 13.126, 13.509, 13.731]
    fid_qua_arr = [14.008, 13.910, 12.684, 12.496, 13.295, 13.333, 13.641, 14.862, 14.459]
    fid_uni_arr = [16.834, 14.241, 12.637, 11.856, 13.157, 14.539, 15.074, 15.073, 15.205]
    lambda_str = '1E07'
    draw_fig(fid_snr_arr, fid_qua_arr, fid_uni_arr, lambda_str)
    fid_snr_arr = [21.087, 18.517, 15.433, 14.332, 14.606, 14.664, 14.861, 14.449, 14.589]
    fid_qua_arr = [14.008, 13.761, 12.163, 11.922, 11.620, 11.724, 11.841, 11.813, 11.799]
    fid_uni_arr = [16.834, 14.224, 12.705, 16.059, 18.232, 19.020, 20.095, 19.801, 18.949]
    lambda_str = '1E08'
    draw_fig(fid_snr_arr, fid_qua_arr, fid_uni_arr, lambda_str)

def dual_loss_reverse_time_ode_gradient():
    def dm_grad_fn(x_0, epsilon, t):
        grad = -(9.95 * t + 0.05) * math.exp(-4.975 * t * t - 0.05 * t) * x_0
        exp2 = math.exp(-9.95 * t * t - 0.1 * t)
        grad += (9.95 * t + 0.05) * exp2 / math.sqrt(1 - exp2) * epsilon
        return grad

    ts_arr = list(range(1, 1000, 1)) # todo: change step back.
    ts_arr = [step / 1000 for step in ts_arr] # 0.01 ~ 0.999
    ep_arr = [0.6, 0.0, -0.6]   # epsilon array
    x0_arr = [0.7, 0.1, -0.5]   # x_0 array
    fig = plt.figure(figsize=(20, 8))
    ax = fig.add_subplot(1, 1, 1)
    ax.tick_params('both', labelsize=20)
    line_arr = []
    # (0, (5, 10)): loosely dash
    # (5, (10, 3)): long dash with offset
    for ep, l_stype in zip(ep_arr, ['-', (0, (5, 10)), ':']):
        for x0, l_color in zip(x0_arr, ['r', 'g', 'b']):
            grad_arr = []
            for ts in ts_arr:
                gr = dm_grad_fn(x0, ep, ts)
                grad_arr.append(gr)
            # for
            lbl = f"$\\epsilon$:{ep}, $x_0$:{x0}"
            line, = ax.plot(ts_arr, grad_arr, label=lbl, linestyle=l_stype, color=l_color)
            line_arr.append(line)
        # for
    # for
    plt.gca().invert_xaxis() # reverse time ODE. So reverse X axis.
    legend1 = ax.legend(handles=line_arr[:3], fontsize=24, loc='upper left') # multiple legend
    plt.gca().add_artist(legend1)
    legend2 = ax.legend(handles=line_arr[3:6], fontsize=24, loc=(0.307, 0.707))
    plt.gca().add_artist(legend2)
    ax.legend(handles=line_arr[6:], fontsize=24, loc='lower left')

    fig.supylabel(r'    $\frac{dx_t}{dt}$', fontsize=40, rotation=0)  # make it horizontal
    fig.supxlabel(r'reverse-time timestep $t$', fontsize=30)
    fig.suptitle("Diffusion model reverse-time ODE on specific points", fontsize=30)
    # plt.show()
    f_path = './configs/chart_dual_loss/fig_reverse_time_ode_grad_dm.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file saved: {f_path}")
    plt.close()

def dual_loss_negative_effect():
    """there will be two 0.125 areas."""
    x = np.linspace(0.0, 1, 1001)
    x1 = np.linspace(0.0, 0.5, 501)
    y11 = 1.0 * x1
    y12 = [0.0] * len(x1)
    x2 = np.linspace(0.5, 1.0, 501)
    y21 = 1.0 * x2
    y22 = [1.0] * len(x2)

    # remove bounding box
    plt.rc('axes.spines', **{'bottom': True, 'left': True, 'right': False, 'top': False})
    fig, ax = plt.subplots(1, 1, figsize=(12, 12))
    ax.tick_params('both', labelsize=30)

    for val in [0.0, 0.5, 1.0]:
        lst = [val] * len(x)
        ax.plot(x, lst, linestyle='--', color='0.8')  # y = val
        ax.plot(lst, x, linestyle='--', color='0.8')  # x = val
    ax.fill_between(x1, y11, y12)
    ax.fill_between(x2, y21, y22)
    ax.set_title('Negative Effect of Consistency Term', fontsize=45)
    ax.set_xlabel(r"$a$", fontsize=40)
    ax.set_ylabel(r"$b$    ", fontsize=40, rotation=0)
    text_kwargs = dict(ha='center', va='center', fontsize=40, color='w')
    plt.text(0.3, 0.1, r"$b < a < 0.5$", text_kwargs)
    plt.text(0.7, 0.9, r"$b > a > 0.5$", text_kwargs)
    fig.tight_layout()

    f_path = './configs/chart_dual_loss/fig_negative_effect.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file saved: {f_path}")
    plt.close()

def dual_loss_trajectory_diffusion_vs_rectified_flow():
    x1k_df = [0.257086, 0.257072, 0.257058, 0.257044, 0.257030, 0.257017, 0.257004, 0.256990, 0.256977, 0.256963,
              0.256949, 0.256935, 0.256921, 0.256907, 0.256892, 0.256877, 0.256862, 0.256848, 0.256833, 0.256818,
              0.256802, 0.256787, 0.256772, 0.256757, 0.256742, 0.256727, 0.256711, 0.256696, 0.256680, 0.256663,
              0.256646, 0.256629, 0.256612, 0.256596, 0.256579, 0.256562, 0.256545, 0.256528, 0.256511, 0.256492,
              0.256474, 0.256455, 0.256436, 0.256417, 0.256398, 0.256378, 0.256359, 0.256340, 0.256322, 0.256302,
              0.256283, 0.256263, 0.256244, 0.256224, 0.256204, 0.256184, 0.256163, 0.256141, 0.256120, 0.256098,
              0.256075, 0.256053, 0.256031, 0.256008, 0.255985, 0.255961, 0.255937, 0.255913, 0.255889, 0.255865,
              0.255840, 0.255815, 0.255789, 0.255765, 0.255739, 0.255713, 0.255686, 0.255659, 0.255631, 0.255603,
              0.255575, 0.255546, 0.255517, 0.255489, 0.255459, 0.255430, 0.255400, 0.255369, 0.255338, 0.255307,
              0.255275, 0.255243, 0.255211, 0.255177, 0.255144, 0.255110, 0.255076, 0.255041, 0.255005, 0.254969,
              0.254933, 0.254897, 0.254860, 0.254822, 0.254784, 0.254746, 0.254707, 0.254668, 0.254628, 0.254587,
              0.254545, 0.254504, 0.254463, 0.254421, 0.254378, 0.254334, 0.254290, 0.254245, 0.254199, 0.254154,
              0.254107, 0.254060, 0.254012, 0.253965, 0.253916, 0.253868, 0.253818, 0.253768, 0.253718, 0.253668,
              0.253616, 0.253564, 0.253512, 0.253458, 0.253405, 0.253351, 0.253296, 0.253241, 0.253186, 0.253130,
              0.253075, 0.253018, 0.252961, 0.252903, 0.252845, 0.252785, 0.252726, 0.252665, 0.252605, 0.252544,
              0.252483, 0.252421, 0.252358, 0.252295, 0.252231, 0.252167, 0.252102, 0.252036, 0.251969, 0.251902,
              0.251835, 0.251767, 0.251698, 0.251629, 0.251560, 0.251490, 0.251419, 0.251348, 0.251276, 0.251203,
              0.251130, 0.251056, 0.250981, 0.250906, 0.250831, 0.250755, 0.250679, 0.250603, 0.250526, 0.250448,
              0.250371, 0.250293, 0.250214, 0.250135, 0.250055, 0.249975, 0.249894, 0.249814, 0.249733, 0.249652,
              0.249571, 0.249489, 0.249407, 0.249325, 0.249243, 0.249161, 0.249079, 0.248996, 0.248914, 0.248832,
              0.248749, 0.248667, 0.248586, 0.248504, 0.248423, 0.248342, 0.248260, 0.248179, 0.248098, 0.248018,
              0.247938, 0.247859, 0.247780, 0.247701, 0.247623, 0.247546, 0.247469, 0.247393, 0.247318, 0.247243,
              0.247169, 0.247096, 0.247024, 0.246952, 0.246882, 0.246813, 0.246745, 0.246678, 0.246612, 0.246547,
              0.246484, 0.246422, 0.246362, 0.246304, 0.246248, 0.246193, 0.246139, 0.246086, 0.246036, 0.245987,
              0.245941, 0.245897, 0.245854, 0.245813, 0.245774, 0.245737, 0.245702, 0.245668, 0.245637, 0.245607,
              0.245581, 0.245557, 0.245535, 0.245515, 0.245498, 0.245483, 0.245471, 0.245461, 0.245453, 0.245448,
              0.245447, 0.245448, 0.245452, 0.245459, 0.245468, 0.245480, 0.245496, 0.245514, 0.245534, 0.245558,
              0.245585, 0.245615, 0.245647, 0.245682, 0.245721, 0.245762, 0.245807, 0.245854, 0.245904, 0.245958,
              0.246014, 0.246072, 0.246134, 0.246199, 0.246267, 0.246339, 0.246413, 0.246490, 0.246570, 0.246652,
              0.246737, 0.246826, 0.246918, 0.247013, 0.247110, 0.247210, 0.247313, 0.247420, 0.247530, 0.247643,
              0.247760, 0.247879, 0.248002, 0.248127, 0.248257, 0.248390, 0.248527, 0.248666, 0.248809, 0.248955,
              0.249104, 0.249257, 0.249413, 0.249573, 0.249736, 0.249903, 0.250073, 0.250247, 0.250425, 0.250607,
              0.250793, 0.250982, 0.251174, 0.251370, 0.251571, 0.251776, 0.251985, 0.252199, 0.252416, 0.252638,
              0.252864, 0.253094, 0.253330, 0.253570, 0.253815, 0.254064, 0.254316, 0.254574, 0.254835, 0.255102,
              0.255373, 0.255650, 0.255932, 0.256219, 0.256510, 0.256806, 0.257105, 0.257411, 0.257721, 0.258036,
              0.258355, 0.258678, 0.259006, 0.259340, 0.259678, 0.260020, 0.260368, 0.260721, 0.261077, 0.261440,
              0.261806, 0.262177, 0.262553, 0.262934, 0.263318, 0.263708, 0.264103, 0.264501, 0.264903, 0.265310,
              0.265721, 0.266136, 0.266555, 0.266979, 0.267408, 0.267840, 0.268277, 0.268718, 0.269164, 0.269614,
              0.270068, 0.270527, 0.270990, 0.271457, 0.271929, 0.272404, 0.272882, 0.273365, 0.273851, 0.274341,
              0.274835, 0.275332, 0.275833, 0.276339, 0.276848, 0.277361, 0.277877, 0.278396, 0.278917, 0.279443,
              0.279972, 0.280505, 0.281041, 0.281580, 0.282122, 0.282666, 0.283215, 0.283766, 0.284321, 0.284879,
              0.285441, 0.286005, 0.286573, 0.287144, 0.287718, 0.288296, 0.288877, 0.289460, 0.290046, 0.290634,
              0.291227, 0.291822, 0.292420, 0.293019, 0.293622, 0.294228, 0.294837, 0.295449, 0.296063, 0.296679,
              0.297298, 0.297919, 0.298544, 0.299172, 0.299802, 0.300433, 0.301067, 0.301705, 0.302345, 0.302989,
              0.303634, 0.304282, 0.304932, 0.305584, 0.306239, 0.306895, 0.307554, 0.308216, 0.308879, 0.309546,
              0.310214, 0.310885, 0.311558, 0.312234, 0.312912, 0.313592, 0.314275, 0.314959, 0.315645, 0.316334,
              0.317025, 0.317718, 0.318413, 0.319110, 0.319809, 0.320511, 0.321215, 0.321920, 0.322628, 0.323336,
              0.324047, 0.324760, 0.325476, 0.326193, 0.326911, 0.327632, 0.328355, 0.329080, 0.329806, 0.330534,
              0.331264, 0.331995, 0.332728, 0.333462, 0.334199, 0.334938, 0.335678, 0.336420, 0.337163, 0.337908,
              0.338654, 0.339402, 0.340152, 0.340902, 0.341655, 0.342409, 0.343164, 0.343921, 0.344679, 0.345439,
              0.346199, 0.346961, 0.347725, 0.348491, 0.349258, 0.350026, 0.350795, 0.351567, 0.352339, 0.353112,
              0.353887, 0.354662, 0.355439, 0.356217, 0.356995, 0.357775, 0.358555, 0.359336, 0.360119, 0.360902,
              0.361688, 0.362474, 0.363260, 0.364048, 0.364838, 0.365628, 0.366419, 0.367211, 0.368004, 0.368798,
              0.369593, 0.370388, 0.371184, 0.371981, 0.372779, 0.373578, 0.374377, 0.375177, 0.375978, 0.376779,
              0.377582, 0.378385, 0.379189, 0.379993, 0.380798, 0.381604, 0.382410, 0.383217, 0.384025, 0.384833,
              0.385641, 0.386450, 0.387259, 0.388069, 0.388879, 0.389691, 0.390503, 0.391315, 0.392127, 0.392940,
              0.393754, 0.394568, 0.395382, 0.396196, 0.397011, 0.397826, 0.398641, 0.399457, 0.400272, 0.401089,
              0.401905, 0.402721, 0.403537, 0.404353, 0.405168, 0.405985, 0.406802, 0.407618, 0.408435, 0.409252,
              0.410068, 0.410885, 0.411701, 0.412518, 0.413335, 0.414152, 0.414968, 0.415784, 0.416600, 0.417417,
              0.418234, 0.419050, 0.419865, 0.420681, 0.421497, 0.422313, 0.423129, 0.423945, 0.424759, 0.425574,
              0.426389, 0.427203, 0.428018, 0.428832, 0.429644, 0.430457, 0.431269, 0.432082, 0.432894, 0.433706,
              0.434517, 0.435329, 0.436139, 0.436949, 0.437758, 0.438566, 0.439375, 0.440184, 0.440991, 0.441798,
              0.442605, 0.443412, 0.444218, 0.445023, 0.445828, 0.446634, 0.447438, 0.448241, 0.449044, 0.449846,
              0.450647, 0.451447, 0.452247, 0.453046, 0.453844, 0.454640, 0.455437, 0.456233, 0.457028, 0.457823,
              0.458617, 0.459411, 0.460203, 0.460995, 0.461785, 0.462576, 0.463364, 0.464152, 0.464940, 0.465727,
              0.466512, 0.467296, 0.468080, 0.468862, 0.469643, 0.470424, 0.471204, 0.471982, 0.472760, 0.473538,
              0.474313, 0.475088, 0.475862, 0.476634, 0.477405, 0.478175, 0.478945, 0.479712, 0.480479, 0.481246,
              0.482010, 0.482774, 0.483537, 0.484298, 0.485058, 0.485818, 0.486576, 0.487332, 0.488088, 0.488842,
              0.489594, 0.490347, 0.491096, 0.491844, 0.492593, 0.493338, 0.494083, 0.494828, 0.495569, 0.496310,
              0.497050, 0.497788, 0.498525, 0.499261, 0.499994, 0.500728, 0.501458, 0.502187, 0.502915, 0.503640,
              0.504365, 0.505088, 0.505809, 0.506530, 0.507249, 0.507967, 0.508684, 0.509397, 0.510110, 0.510821,
              0.511531, 0.512240, 0.512945, 0.513650, 0.514354, 0.515055, 0.515756, 0.516453, 0.517151, 0.517846,
              0.518540, 0.519233, 0.519922, 0.520612, 0.521298, 0.521983, 0.522667, 0.523349, 0.524031, 0.524708,
              0.525386, 0.526060, 0.526733, 0.527404, 0.528073, 0.528742, 0.529406, 0.530072, 0.530733, 0.531394,
              0.532053, 0.532710, 0.533366, 0.534020, 0.534673, 0.535322, 0.535971, 0.536616, 0.537263, 0.537904,
              0.538546, 0.539183, 0.539821, 0.540454, 0.541088, 0.541718, 0.542347, 0.542973, 0.543598, 0.544221,
              0.544841, 0.545461, 0.546078, 0.546694, 0.547307, 0.547919, 0.548528, 0.549136, 0.549741, 0.550345,
              0.550946, 0.551546, 0.552143, 0.552739, 0.553332, 0.553924, 0.554513, 0.555100, 0.555686, 0.556269,
              0.556852, 0.557430, 0.558009, 0.558583, 0.559160, 0.559729, 0.560300, 0.560866, 0.561432, 0.561995,
              0.562557, 0.563117, 0.563675, 0.564232, 0.564784, 0.565338, 0.565885, 0.566435, 0.566979, 0.567523,
              0.568064, 0.568603, 0.569142, 0.569676, 0.570211, 0.570740, 0.571270, 0.571797, 0.572322, 0.572847,
              0.573366, 0.573888, 0.574404, 0.574920, 0.575434, 0.575944, 0.576457, 0.576962, 0.577468, 0.577972,
              0.578473, 0.578976, 0.579470, 0.579967, 0.580461, 0.580951, 0.581444, 0.581929, 0.582416, 0.582901,
              0.583381, 0.583864, 0.584341, 0.584817, 0.585295, 0.585764, 0.586235, 0.586705, 0.587169, 0.587636,
              0.588099, 0.588558, 0.589020, 0.589475, 0.589930, 0.590387, 0.590834, 0.591284, 0.591735, 0.592176,
              0.592621, 0.593066, 0.593502, 0.593941, 0.594380, 0.594811, 0.595244, 0.595677, 0.596102, 0.596529,
              0.596957, 0.597376, 0.597797, 0.598221, 0.598633, 0.599048, 0.599466, 0.599874, 0.600283, 0.600694,
              0.601099, 0.601501, 0.601906, 0.602308, 0.602703, 0.603101, 0.603501, 0.603890, 0.604280, 0.604672,
              0.605060, 0.605442, 0.605827, 0.606214, 0.606589, 0.606966, 0.607346, 0.607722, 0.608091, 0.608462,
              0.608836, 0.609201, 0.609564, 0.609929, 0.610296, 0.610652, 0.611007, 0.611365, 0.611726, 0.612072,
              0.612420, 0.612771, 0.613124, 0.613462, 0.613803, 0.614146, 0.614491, 0.614824, 0.615156, 0.615490,
              0.615827, 0.616156, 0.616479, 0.616805, 0.617132, 0.617460, 0.617774, 0.618090, 0.618408, 0.618728,
              0.619041, 0.619346, 0.619653, 0.619962, 0.620273, 0.620573, 0.620869, 0.621166, 0.621465, 0.621766,
              0.622057, 0.622342, 0.622629, 0.622916, 0.623206, 0.623492, 0.623765, 0.624039, 0.624315, 0.624592,
              0.624871, 0.625137, 0.625397, 0.625659, 0.625922, 0.626187, 0.626453, 0.626703, 0.626950, 0.627196,
              0.627445, 0.627694, 0.627943, 0.628186, 0.628415, 0.628644, 0.628873, 0.629103, 0.629332, 0.629562,
              0.629784, 0.629991, 0.630198, 0.630405, 0.630611, 0.630817, 0.631021, 0.631226, 0.631415, 0.631593,
              0.631771, 0.631949, 0.632123, 0.632296, 0.632467, 0.632636, 0.632802, 0.632948, 0.633088, 0.633228,
              0.633363, 0.633498, 0.633629, 0.633758, 0.633885, 0.634010, 0.634134, 0.634245, 0.634347, 0.634450,
              0.634550, 0.634650, 0.634750, 0.634849, 0.634949, 0.635048, 0.635148, 0.635248, 0.635348, 0.635449,
              0.635549] # diffusion
    y1k_df = [0.952998, 0.952969, 0.952942, 0.952916, 0.952891, 0.952865, 0.952839, 0.952813, 0.952787, 0.952760,
              0.952733, 0.952707, 0.952680, 0.952653, 0.952626, 0.952598, 0.952569, 0.952541, 0.952513, 0.952484,
              0.952455, 0.952425, 0.952394, 0.952363, 0.952332, 0.952301, 0.952271, 0.952241, 0.952210, 0.952177,
              0.952145, 0.952114, 0.952081, 0.952048, 0.952016, 0.951982, 0.951948, 0.951913, 0.951876, 0.951840,
              0.951803, 0.951767, 0.951730, 0.951692, 0.951654, 0.951616, 0.951577, 0.951538, 0.951499, 0.951460,
              0.951420, 0.951380, 0.951339, 0.951297, 0.951255, 0.951213, 0.951168, 0.951123, 0.951078, 0.951032,
              0.950987, 0.950941, 0.950893, 0.950844, 0.950795, 0.950745, 0.950695, 0.950644, 0.950594, 0.950542,
              0.950490, 0.950437, 0.950383, 0.950328, 0.950272, 0.950216, 0.950158, 0.950099, 0.950039, 0.949979,
              0.949917, 0.949854, 0.949792, 0.949728, 0.949664, 0.949598, 0.949532, 0.949464, 0.949395, 0.949325,
              0.949254, 0.949182, 0.949109, 0.949035, 0.948959, 0.948883, 0.948806, 0.948727, 0.948647, 0.948565,
              0.948483, 0.948400, 0.948316, 0.948232, 0.948146, 0.948058, 0.947969, 0.947879, 0.947788, 0.947694,
              0.947601, 0.947506, 0.947410, 0.947311, 0.947212, 0.947112, 0.947011, 0.946909, 0.946805, 0.946700,
              0.946593, 0.946485, 0.946375, 0.946263, 0.946150, 0.946036, 0.945920, 0.945802, 0.945683, 0.945562,
              0.945440, 0.945316, 0.945190, 0.945063, 0.944935, 0.944806, 0.944675, 0.944542, 0.944408, 0.944272,
              0.944135, 0.943995, 0.943853, 0.943709, 0.943564, 0.943417, 0.943270, 0.943120, 0.942968, 0.942813,
              0.942658, 0.942500, 0.942341, 0.942179, 0.942015, 0.941849, 0.941681, 0.941510, 0.941336, 0.941159,
              0.940981, 0.940800, 0.940618, 0.940433, 0.940247, 0.940058, 0.939866, 0.939671, 0.939474, 0.939275,
              0.939072, 0.938867, 0.938660, 0.938450, 0.938238, 0.938024, 0.937806, 0.937586, 0.937363, 0.937137,
              0.936909, 0.936678, 0.936444, 0.936207, 0.935966, 0.935723, 0.935477, 0.935228, 0.934976, 0.934720,
              0.934461, 0.934199, 0.933936, 0.933668, 0.933397, 0.933123, 0.932845, 0.932565, 0.932281, 0.931994,
              0.931702, 0.931408, 0.931110, 0.930809, 0.930505, 0.930198, 0.929886, 0.929570, 0.929251, 0.928927,
              0.928600, 0.928269, 0.927934, 0.927596, 0.927254, 0.926907, 0.926556, 0.926202, 0.925844, 0.925483,
              0.925117, 0.924746, 0.924371, 0.923992, 0.923609, 0.923223, 0.922832, 0.922436, 0.922036, 0.921632,
              0.921224, 0.920812, 0.920393, 0.919969, 0.919541, 0.919110, 0.918676, 0.918237, 0.917792, 0.917342,
              0.916888, 0.916428, 0.915965, 0.915496, 0.915022, 0.914544, 0.914062, 0.913575, 0.913083, 0.912587,
              0.912085, 0.911577, 0.911066, 0.910549, 0.910028, 0.909502, 0.908971, 0.908435, 0.907894, 0.907347,
              0.906795, 0.906238, 0.905675, 0.905108, 0.904536, 0.903958, 0.903375, 0.902787, 0.902195, 0.901596,
              0.900993, 0.900385, 0.899773, 0.899156, 0.898534, 0.897906, 0.897274, 0.896637, 0.895995, 0.895348,
              0.894696, 0.894040, 0.893378, 0.892712, 0.892040, 0.891364, 0.890682, 0.889996, 0.889306, 0.888612,
              0.887913, 0.887209, 0.886500, 0.885786, 0.885067, 0.884344, 0.883617, 0.882884, 0.882147, 0.881405,
              0.880659, 0.879907, 0.879151, 0.878389, 0.877622, 0.876850, 0.876073, 0.875292, 0.874506, 0.873714,
              0.872918, 0.872117, 0.871310, 0.870499, 0.869683, 0.868862, 0.868036, 0.867205, 0.866367, 0.865525,
              0.864677, 0.863825, 0.862968, 0.862106, 0.861237, 0.860364, 0.859484, 0.858599, 0.857710, 0.856815,
              0.855915, 0.855008, 0.854096, 0.853178, 0.852255, 0.851326, 0.850392, 0.849452, 0.848508, 0.847558,
              0.846602, 0.845641, 0.844672, 0.843698, 0.842719, 0.841734, 0.840744, 0.839748, 0.838747, 0.837740,
              0.836729, 0.835713, 0.834690, 0.833662, 0.832628, 0.831588, 0.830543, 0.829492, 0.828436, 0.827373,
              0.826306, 0.825233, 0.824154, 0.823070, 0.821980, 0.820885, 0.819784, 0.818677, 0.817566, 0.816448,
              0.815325, 0.814198, 0.813065, 0.811927, 0.810784, 0.809635, 0.808482, 0.807323, 0.806158, 0.804989,
              0.803814, 0.802633, 0.801448, 0.800258, 0.799062, 0.797861, 0.796656, 0.795446, 0.794231, 0.793011,
              0.791786, 0.790557, 0.789323, 0.788083, 0.786839, 0.785590, 0.784337, 0.783080, 0.781819, 0.780554,
              0.779283, 0.778008, 0.776729, 0.775446, 0.774159, 0.772869, 0.771573, 0.770273, 0.768969, 0.767661,
              0.766349, 0.765033, 0.763713, 0.762389, 0.761061, 0.759729, 0.758394, 0.757055, 0.755713, 0.754368,
              0.753017, 0.751664, 0.750307, 0.748947, 0.747584, 0.746217, 0.744847, 0.743474, 0.742098, 0.740720,
              0.739339, 0.737954, 0.736567, 0.735176, 0.733783, 0.732387, 0.730989, 0.729588, 0.728184, 0.726778,
              0.725369, 0.723957, 0.722544, 0.721128, 0.719710, 0.718291, 0.716870, 0.715446, 0.714020, 0.712593,
              0.711164, 0.709732, 0.708299, 0.706864, 0.705427, 0.703988, 0.702548, 0.701107, 0.699665, 0.698221,
              0.696775, 0.695327, 0.693879, 0.692429, 0.690977, 0.689525, 0.688071, 0.686617, 0.685161, 0.683705,
              0.682248, 0.680789, 0.679330, 0.677869, 0.676408, 0.674947, 0.673485, 0.672023, 0.670560, 0.669097,
              0.667634, 0.666171, 0.664707, 0.663243, 0.661778, 0.660313, 0.658849, 0.657384, 0.655919, 0.654455,
              0.652991, 0.651527, 0.650064, 0.648601, 0.647138, 0.645675, 0.644213, 0.642752, 0.641291, 0.639831,
              0.638371, 0.636911, 0.635452, 0.633992, 0.632534, 0.631076, 0.629619, 0.628163, 0.626708, 0.625254,
              0.623801, 0.622350, 0.620899, 0.619450, 0.618001, 0.616554, 0.615108, 0.613662, 0.612218, 0.610776,
              0.609334, 0.607894, 0.606455, 0.605018, 0.603582, 0.602148, 0.600715, 0.599284, 0.597855, 0.596428,
              0.595002, 0.593578, 0.592156, 0.590737, 0.589319, 0.587903, 0.586490, 0.585079, 0.583669, 0.582261,
              0.580856, 0.579452, 0.578050, 0.576650, 0.575252, 0.573856, 0.572462, 0.571071, 0.569682, 0.568296,
              0.566911, 0.565530, 0.564151, 0.562774, 0.561400, 0.560029, 0.558660, 0.557295, 0.555932, 0.554571,
              0.553213, 0.551857, 0.550504, 0.549154, 0.547806, 0.546462, 0.545120, 0.543782, 0.542446, 0.541114,
              0.539785, 0.538458, 0.537135, 0.535816, 0.534499, 0.533186, 0.531875, 0.530567, 0.529261, 0.527959,
              0.526661, 0.525366, 0.524074, 0.522785, 0.521500, 0.520217, 0.518938, 0.517663, 0.516392, 0.515123,
              0.513858, 0.512596, 0.511338, 0.510083, 0.508832, 0.507585, 0.506341, 0.505100, 0.503865, 0.502632,
              0.501403, 0.500178, 0.498956, 0.497738, 0.496525, 0.495315, 0.494108, 0.492905, 0.491706, 0.490511,
              0.489320, 0.488132, 0.486947, 0.485768, 0.484592, 0.483419, 0.482250, 0.481085, 0.479925, 0.478769,
              0.477616, 0.476467, 0.475322, 0.474182, 0.473046, 0.471913, 0.470785, 0.469662, 0.468543, 0.467428,
              0.466316, 0.465210, 0.464108, 0.463010, 0.461915, 0.460826, 0.459740, 0.458659, 0.457581, 0.456509,
              0.455440, 0.454375, 0.453315, 0.452260, 0.451208, 0.450160, 0.449117, 0.448079, 0.447044, 0.446013,
              0.444987, 0.443966, 0.442948, 0.441934, 0.440926, 0.439921, 0.438920, 0.437926, 0.436935, 0.435947,
              0.434965, 0.433987, 0.433013, 0.432043, 0.431078, 0.430117, 0.429160, 0.428209, 0.427261, 0.426317,
              0.425380, 0.424446, 0.423515, 0.422591, 0.421670, 0.420752, 0.419840, 0.418932, 0.418027, 0.417128,
              0.416233, 0.415341, 0.414455, 0.413573, 0.412694, 0.411821, 0.410953, 0.410087, 0.409228, 0.408372,
              0.407520, 0.406674, 0.405831, 0.404993, 0.404159, 0.403328, 0.402503, 0.401682, 0.400863, 0.400051,
              0.399242, 0.398437, 0.397637, 0.396840, 0.396049, 0.395262, 0.394478, 0.393700, 0.392925, 0.392155,
              0.391389, 0.390626, 0.389870, 0.389116, 0.388368, 0.387623, 0.386882, 0.386147, 0.385414, 0.384686,
              0.383962, 0.383242, 0.382527, 0.381815, 0.381109, 0.380405, 0.379706, 0.379012, 0.378320, 0.377635,
              0.376951, 0.376273, 0.375598, 0.374927, 0.374261, 0.373598, 0.372941, 0.372285, 0.371636, 0.370989,
              0.370347, 0.369709, 0.369074, 0.368444, 0.367817, 0.367195, 0.366576, 0.365962, 0.365350, 0.364745,
              0.364141, 0.363543, 0.362947, 0.362356, 0.361768, 0.361184, 0.360604, 0.360027, 0.359455, 0.358886,
              0.358321, 0.357759, 0.357202, 0.356647, 0.356097, 0.355550, 0.355007, 0.354468, 0.353932, 0.353400,
              0.352872, 0.352346, 0.351825, 0.351307, 0.350793, 0.350282, 0.349775, 0.349271, 0.348770, 0.348274,
              0.347779, 0.347290, 0.346802, 0.346320, 0.345838, 0.345363, 0.344889, 0.344421, 0.343953, 0.343491,
              0.343031, 0.342574, 0.342121, 0.341670, 0.341224, 0.340779, 0.340340, 0.339901, 0.339468, 0.339036,
              0.338608, 0.338184, 0.337761, 0.337344, 0.336926, 0.336516, 0.336105, 0.335699, 0.335296, 0.334894,
              0.334498, 0.334101, 0.333711, 0.333322, 0.332936, 0.332554, 0.332171, 0.331796, 0.331421, 0.331050,
              0.330682, 0.330313, 0.329952, 0.329591, 0.329232, 0.328878, 0.328524, 0.328176, 0.327828, 0.327483,
              0.327143, 0.326802, 0.326466, 0.326132, 0.325798, 0.325471, 0.325144, 0.324819, 0.324499, 0.324178,
              0.323861, 0.323548, 0.323234, 0.322925, 0.322619, 0.322311, 0.322011, 0.321711, 0.321411, 0.321118,
              0.320824, 0.320532, 0.320245, 0.319959, 0.319673, 0.319393, 0.319113, 0.318834, 0.318561, 0.318288,
              0.318015, 0.317749, 0.317483, 0.317216, 0.316957, 0.316697, 0.316437, 0.316184, 0.315931, 0.315678,
              0.315429, 0.315183, 0.314937, 0.314693, 0.314454, 0.314214, 0.313975, 0.313742, 0.313510, 0.313277,
              0.313049, 0.312823, 0.312598, 0.312371, 0.312153, 0.311935, 0.311716, 0.311500, 0.311288, 0.311077,
              0.310864, 0.310658, 0.310454, 0.310249, 0.310044, 0.309846, 0.309648, 0.309450, 0.309252, 0.309062,
              0.308872, 0.308682, 0.308490, 0.308308, 0.308125, 0.307942, 0.307758, 0.307581, 0.307406, 0.307230,
              0.307053, 0.306881, 0.306713, 0.306545, 0.306376, 0.306207, 0.306047, 0.305886, 0.305725, 0.305563,
              0.305405, 0.305252, 0.305099, 0.304945, 0.304791, 0.304642, 0.304497, 0.304351, 0.304205, 0.304058,
              0.303917, 0.303780, 0.303642, 0.303504, 0.303365, 0.303229, 0.303100, 0.302971, 0.302841, 0.302711,
              0.302580, 0.302457, 0.302336, 0.302215, 0.302094, 0.301973, 0.301852, 0.301738, 0.301626, 0.301515,
              0.301403, 0.301291, 0.301180, 0.301071, 0.300970, 0.300868, 0.300767, 0.300665, 0.300564, 0.300463,
              0.300366, 0.300275, 0.300185, 0.300095, 0.300004, 0.299914, 0.299825, 0.299736, 0.299653, 0.299574,
              0.299495, 0.299417, 0.299339, 0.299261, 0.299184, 0.299107, 0.299030, 0.298962, 0.298896, 0.298830,
              0.298764, 0.298699, 0.298635, 0.298570, 0.298506, 0.298443, 0.298380, 0.298323, 0.298270, 0.298218,
              0.298168, 0.298119, 0.298070, 0.298023, 0.297977, 0.297932, 0.297887, 0.297844, 0.297800, 0.297757,
              0.297714] # diffusion
    y1k_df = [y - 0.07 for y in y1k_df]  # adjust value of y
    x01_rf = [x1k_df[0], x1k_df[-1]]    # rectified flow
    y01_rf = [y1k_df[0], y1k_df[-1]]    # rectified flow
    fig = plt.figure(figsize=(16, 8))
    ax = fig.add_subplot(1, 1, 1)
    ax.tick_params('both', labelsize=30)
    ax.plot(x1k_df, y1k_df, linestyle='-', color='r')
    ax.plot(x01_rf, y01_rf, linestyle='-', color='b', marker='o', ms=6)
    legends = ['Diffusion models trajectory', 'Rectified Flow trajectory']
    ax.legend(legends, fontsize=35, loc='upper right')
    ax.set_title(f"Trajectory: Diffusion models vs Rectified Flow", fontsize=40)
    ax.set_xlabel(r"$x_t[a]$",  fontsize=35)
    ax.set_ylabel(r"$x_t[b]$        ", fontsize=35, rotation=0)
    ax.set_ylim((0.1, 1.0))
    text_kwargs = dict(ha='center', va='center', fontsize=40, color='k')
    # plt.text(0.25, 0.94, r"$\pi_1$", text_kwargs)
    # plt.text(0.64, 0.27, r"$\pi_0$", text_kwargs)
    fig.tight_layout()

    f_path = './configs/chart_dual_loss/fig_trajectory1_diffusion_vs_rectified_flow.png'
    fig.savefig(f_path, bbox_inches='tight')
    print(f"file saved: {f_path}")
    plt.close()

def dual_loss_merge_image_col_row():
    root_dir = './output3_rf_celeba_sampling'
    lambda_arr = ['0.0', '0.1', '0.2', '0.3', '0.4', '0.5', '0.6', '0.7', '0.8', '0.9', '1.0']
    # step_arr = ['1', '2', '3', '4', '5', '6', '7', '8', '9', '10']
    step_arr = ['1', '2', '3']
    save_dir = os.path.join(root_dir, f"merged")
    if not os.path.exists(save_dir):
        print(f"mkdirs: {save_dir}")
        os.makedirs(save_dir)
    # first_dir = os.path.join(root_dir, f"gen_lambda{lambda_arr[0]}_step{step_arr[0]}")
    # fname_list = os.listdir(first_dir)
    # fname_list.sort()
    fname_list = ['00026.png']
    for fname in fname_list:
        img_arr = []
        for step in step_arr:
            for lda in lambda_arr:
                img_path = os.path.join(root_dir, f"gen_lambda{lda}_step{step}", fname)
                # img = tv.io.read_image(img_path) # dimension [3, 64, 64]
                # img = img.float()
                # img /= 255.0
                img = plt.imread(img_path) # dimension: [64, 64, 3]
                img = torch.tensor(img)
                img = img.permute(2, 0, 1)
                img_arr.append(img)
                tv.utils.save_image(img, os.path.join(save_dir, f"lambda{lda}_step{step}.png"))
            # for
        # for
        save_img_path = os.path.join(save_dir, fname)
        tv.utils.save_image(img_arr, save_img_path, nrow=len(lambda_arr))
        print(f"save image: {save_img_path}")
    # for fname

def dual_loss_group_image():
    import shutil
    root_dir = './output3_rf_celeba_sampling'
    lambda_arr = ['0.0', '0.7']
    step_arr = ['3']
    save_dir = os.path.join(root_dir, f"aaa_group")
    if not os.path.exists(save_dir):
        print(f"mkdirs: {save_dir}")
        os.makedirs(save_dir)
    fname_list = [
        '00002', '00011', '00019', '00026', '00039',
        '00041', '00042', '00043', '00051', '00059',
        '00062', '00069', '00081', '00086', '00097',
        '00103', '00107', '00109', '00116', '00117',
    ]
    for fname in fname_list:
        for step in step_arr:
            for lda in lambda_arr:
                img_path = os.path.join(root_dir, f"gen_lambda{lda}_step{step}", f"{fname}.png")
                save_img_path = os.path.join(save_dir, f"{fname}_lambda{lda}_step{step}.png")
                shutil.copyfile(img_path, save_img_path)
                print(f"save image: {save_img_path}")
            # for
        # for
    # for fname

def main():
    """ entry point """
    # fig_trajectory_ori_vs_new()
    # merge_image()
    # mse_error_vs_alpha_bar()
    # fid_compare_ddim_cifar10()
    # fid_compare_ddim_bedroom()
    # fid_compare_ddim_celeba()
    # fid_compare_pndm_cifar10()
    # fid_compare_splitnm_imagenet()
    # fig_trajectory_compare_all3()
    # discretization_error_vs_prediction_error()
    # prediction_error_distribution()
    # ablation_ddim()
    # dual_loss_reverse_time_ode_gradient()
    # dual_loss_negative_effect()
    # dual_loss_trajectory_diffusion_vs_rectified_flow()
    # dual_loss_merge_image_col_row()
    dual_loss_group_image()

if __name__ == '__main__':
    main()
